module.exports=[23944,a=>{"use strict";var b=a.i(7997),c=a.i(95936),d=a.i(1269);let e=(0,d.default)("scroll-text",[["path",{d:"M15 12h-5",key:"r7krc0"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]]);var f=a.i(82604),g=a.i(93830),h=a.i(56603),i=a.i(77695),j=a.i(11070),k=a.i(46840),l=a.i(60612);let m=(0,d.default)("timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);var n=a.i(23878),o=a.i(93133),p=a.i(89606),q=a.i(55535);function r(a){return a<.01?`$${a.toFixed(6)}`:a<1?`$${a.toFixed(4)}`:`$${a.toFixed(2)}`}function s({operation:a}){return(0,b.jsx)("span",{className:`inline-flex items-center px-2.5 py-1 rounded-lg text-[10px] font-mono uppercase tracking-widest border ${{analyze:"bg-cyan-500/10 text-cyan-400 border-cyan-500/20",generate:"bg-violet-500/10 text-violet-400 border-violet-500/20",discover:"bg-emerald-500/10 text-emerald-400 border-emerald-500/20"}[a]||"bg-zinc-800/50 text-zinc-400 border-zinc-700/50"}`,children:a})}function t({success:a}){return a?(0,b.jsxs)("span",{className:"inline-flex items-center gap-1 text-emerald-400 text-xs font-mono",children:[(0,b.jsx)(f.CheckCircle,{className:"h-3.5 w-3.5"}),"Success"]}):(0,b.jsxs)("span",{className:"inline-flex items-center gap-1 text-red-400 text-xs font-mono",children:[(0,b.jsx)(g.XCircle,{className:"h-3.5 w-3.5"}),"Failed"]})}function u({href:a,active:d,children:e}){return(0,b.jsx)(c.default,{href:a,className:`inline-flex items-center px-3 py-1.5 rounded-lg text-xs font-mono transition-colors border ${d?"bg-violet-500/10 text-violet-400 border-violet-500/20":"bg-zinc-800/50 text-zinc-400 border-zinc-700/50 hover:bg-zinc-700/50 hover:text-zinc-200"}`,children:e})}function v({buckets:a}){let c=Math.max(...a.map(a=>a.count),1);return 0===a.reduce((a,b)=>a+b.count,0)?(0,b.jsx)("div",{className:"flex h-32 items-center justify-center text-zinc-500 text-sm font-mono",children:"No duration data available"}):(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("div",{className:"flex items-end gap-1 h-24",children:a.map(a=>{let d=c>0?a.count/c*100:0;return(0,b.jsx)("div",{className:"flex-1 flex flex-col items-center group",children:(0,b.jsx)("div",{className:"w-full relative",children:(0,b.jsx)("div",{className:"w-full bg-violet-500/80 rounded-t hover:bg-violet-500 transition-colors cursor-pointer",style:{height:`${Math.max(d,2)}%`,minHeight:a.count>0?"4px":"0"},title:`${a.label}: ${a.count} ops`})})},a.label)})}),(0,b.jsx)("div",{className:"flex gap-1",children:a.map(a=>(0,b.jsxs)("div",{className:"flex-1 text-center",children:[(0,b.jsx)("p",{className:"text-[9px] text-zinc-600 font-mono truncate",children:a.label}),(0,b.jsx)("p",{className:"text-xs font-medium text-zinc-400 font-mono",children:a.count})]},a.label))})]})}async function w({searchParams:a}){let d=await a,g=parseInt(d.page||"1",10),w=d.operation,x="true"===d.success||"false"!==d.success&&void 0,y=d.dateRange||"all",{sort:z,order:A}=(0,q.parseSortParams)({sort:d.sort,order:d.order},"created_at","desc"),B={};w&&(B.operation=w),void 0!==x&&(B.success=x);let C=function(a){if("all"===a)return{};let b=new Date,c=new Date(b.getFullYear(),b.getMonth(),b.getDate());switch(a){case"today":return{since:c.toISOString()};case"7days":{let a=new Date(c);return a.setDate(a.getDate()-7),{since:a.toISOString()}}case"30days":{let a=new Date(c);return a.setDate(a.getDate()-30),{since:a.toISOString()}}default:return{}}}(y);C.since&&(B.since=C.since),C.until&&(B.until=C.until);let[D,E,F]=await Promise.all([(0,n.getAIUsageLogs)(B,g,50,z,A),(0,n.getAIUsageStats)(B),(0,n.getDurationDistribution)(B)]),{data:G,total:H}=D,I=Math.ceil(H/50),J="/logs",K=a=>{let b=Object.entries({...d,...a,page:"1"}).filter(([,a])=>void 0!==a&&""!==a).map(([a,b])=>`${a}=${encodeURIComponent(b)}`);return b.length>0?`${J}?${b.join("&")}`:J},L=(a,b)=>(0,q.buildSortUrlHelper)(J,d,a,b);return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(o.PageHeader,{title:"Execution Logs",subtitle:"View all AI operation logs with filtering and details",icon:e,badge:"Debug",badgeColor:"violet",recordCount:H,tableName:"ai_usage_log"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsx)("div",{className:"lg:col-span-2",children:(0,b.jsxs)(p.StatBlockGrid,{columns:4,children:[(0,b.jsx)(p.StatBlock,{label:"Total Operations",value:E.totalOperations.toLocaleString(),icon:e,color:"violet"}),(0,b.jsx)(p.StatBlock,{label:"Total Tokens",value:`${(E.totalTokens/1e3).toFixed(1)}K`,icon:i.Zap,color:"cyan"}),(0,b.jsx)(p.StatBlock,{label:"Total Cost",value:r(E.totalCost),icon:j.DollarSign,color:"amber"}),(0,b.jsx)(p.StatBlock,{label:"Success Rate",value:`${E.successRate.toFixed(1)}%`,icon:f.CheckCircle,color:"emerald"})]})}),(0,b.jsxs)("div",{className:"bg-zinc-900/30 border border-zinc-800/50 rounded-lg p-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,b.jsx)(m,{className:"h-4 w-4 text-zinc-500"}),(0,b.jsx)("span",{className:"text-xs font-mono uppercase tracking-wider text-zinc-500",children:"Response Time"})]}),(0,b.jsx)(v,{buckets:F})]})]}),(0,b.jsxs)("div",{className:"bg-zinc-900/30 border border-zinc-800/50 rounded-lg p-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,b.jsx)("div",{className:"h-2 w-2 rounded-full bg-violet-400 animate-pulse"}),(0,b.jsx)("span",{className:"text-xs font-mono uppercase tracking-wider text-zinc-500",children:"Filters"})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-[10px] font-mono uppercase tracking-wider text-zinc-600",children:"Operation"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(u,{href:K({operation:void 0}),active:!w,children:"All"}),(0,b.jsx)(u,{href:K({operation:"analyze"}),active:"analyze"===w,children:"Analyze"}),(0,b.jsx)(u,{href:K({operation:"generate"}),active:"generate"===w,children:"Generate"}),(0,b.jsx)(u,{href:K({operation:"discover"}),active:"discover"===w,children:"Discover"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-[10px] font-mono uppercase tracking-wider text-zinc-600",children:"Status"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(u,{href:K({success:void 0}),active:void 0===x,children:"All"}),(0,b.jsx)(u,{href:K({success:"true"}),active:!0===x,children:"Success"}),(0,b.jsx)(u,{href:K({success:"false"}),active:!1===x,children:"Failed"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("label",{className:"text-[10px] font-mono uppercase tracking-wider text-zinc-600 flex items-center gap-1",children:[(0,b.jsx)(l.Calendar,{className:"h-3 w-3"}),"Date Range"]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(u,{href:K({dateRange:void 0}),active:"all"===y,children:"All Time"}),(0,b.jsx)(u,{href:K({dateRange:"today"}),active:"today"===y,children:"Today"}),(0,b.jsx)(u,{href:K({dateRange:"7days"}),active:"7days"===y,children:"7 Days"}),(0,b.jsx)(u,{href:K({dateRange:"30days"}),active:"30days"===y,children:"30 Days"})]})]})]})]}),(0,b.jsxs)("div",{className:"bg-zinc-900/30 border border-zinc-800/50 rounded-lg overflow-hidden",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-zinc-800/50 bg-zinc-900/50",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"h-2 w-2 rounded-full bg-emerald-400"}),(0,b.jsx)("span",{className:"text-xs font-mono uppercase tracking-wider text-zinc-500",children:"Log Records"})]}),(0,b.jsxs)("span",{className:"text-xs font-mono text-zinc-600",children:["Showing ",G.length," of ",H.toLocaleString()]})]}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-zinc-800/50 bg-zinc-900/30",children:[(0,b.jsx)(q.SortableHeader,{column:"created_at",label:"Time",currentSort:z,currentOrder:A,buildSortUrl:L}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-[10px] font-mono uppercase tracking-wider text-zinc-500",children:"Operation"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-[10px] font-mono uppercase tracking-wider text-zinc-500",children:"Contractor"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-[10px] font-mono uppercase tracking-wider text-zinc-500",children:"Status"}),(0,b.jsx)(q.SortableHeader,{column:"total_tokens",label:"Tokens",currentSort:z,currentOrder:A,buildSortUrl:L,align:"right"}),(0,b.jsx)(q.SortableHeader,{column:"cost_estimate",label:"Cost",currentSort:z,currentOrder:A,buildSortUrl:L,align:"right"}),(0,b.jsx)(q.SortableHeader,{column:"duration_ms",label:"Duration",currentSort:z,currentOrder:A,buildSortUrl:L,align:"right"})]})}),(0,b.jsx)("tbody",{children:G.map(a=>{var d;let e,f,g,l;return(0,b.jsxs)("tr",{className:"border-b border-zinc-800/30 hover:bg-zinc-800/30",children:[(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-zinc-200 text-xs font-mono",children:(e=new Date(a.created_at),l=Math.floor((g=Math.floor((f=Math.floor((new Date().getTime()-e.getTime())/6e4))/60))/24),f<1?"Just now":f<60?`${f}m ago`:g<24?`${g}h ago`:l<7?`${l}d ago`:e.toLocaleDateString())}),(0,b.jsx)("p",{className:"text-xs text-zinc-600 font-mono",children:new Date(a.created_at).toLocaleTimeString()})]})}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsx)(s,{operation:a.operation}),(0,b.jsx)("span",{className:"text-[10px] text-zinc-600 font-mono",children:a.model})]})}),(0,b.jsx)("td",{className:"px-4 py-3",children:a.contractor?(0,b.jsxs)(c.default,{href:`/contractors/${a.contractor.id}`,className:"flex items-center gap-2 hover:text-cyan-400 transition-colors",children:[(0,b.jsx)(k.Building2,{className:"h-3.5 w-3.5 text-zinc-600"}),(0,b.jsx)("span",{className:"text-zinc-300 text-xs",children:a.contractor.business_name})]}):(0,b.jsx)("span",{className:"text-zinc-600 text-xs",children:"-"})}),(0,b.jsxs)("td",{className:"px-4 py-3",children:[(0,b.jsx)(t,{success:a.success}),a.error_message&&(0,b.jsx)("p",{className:"mt-1 text-[10px] text-red-400 truncate max-w-[200px] font-mono",title:a.error_message,children:a.error_message})]}),(0,b.jsxs)("td",{className:"px-4 py-3 text-right",children:[(0,b.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,b.jsx)(i.Zap,{className:"h-3 w-3 text-zinc-600"}),(0,b.jsx)("span",{className:"text-zinc-300 font-mono text-xs",children:a.total_tokens.toLocaleString()})]}),null!==a.input_tokens&&null!==a.output_tokens&&(0,b.jsxs)("p",{className:"text-[10px] text-zinc-600 font-mono",children:[a.input_tokens.toLocaleString()," in / ",a.output_tokens.toLocaleString()," out"]})]}),(0,b.jsx)("td",{className:"px-4 py-3 text-right",children:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,b.jsx)(j.DollarSign,{className:"h-3 w-3 text-zinc-600"}),(0,b.jsx)("span",{className:"text-zinc-300 font-mono text-xs",children:r(a.cost_estimate)})]})}),(0,b.jsx)("td",{className:"px-4 py-3 text-right",children:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,b.jsx)(h.Clock,{className:"h-3 w-3 text-zinc-600"}),(0,b.jsx)("span",{className:"text-zinc-300 font-mono text-xs",children:null===(d=a.duration_ms)?"-":d<1e3?`${d}ms`:`${(d/1e3).toFixed(1)}s`})]})})]},a.id)})})]})}),0===G.length&&(0,b.jsxs)("div",{className:"p-12 text-center",children:[(0,b.jsx)("div",{className:"inline-flex items-center justify-center h-16 w-16 rounded-full bg-zinc-800/50 border border-zinc-700/50 mb-4",children:(0,b.jsx)(e,{className:"h-8 w-8 text-zinc-600"})}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-zinc-300 mb-1",children:"No logs found"}),(0,b.jsx)("p",{className:"text-sm text-zinc-500 max-w-md mx-auto",children:w||void 0!==x?"Try adjusting your filters or run some operations.":"Logs will appear here once you run the agent scripts."}),(0,b.jsxs)("p",{className:"mt-4 text-xs font-mono text-zinc-600",children:["Table: ",(0,b.jsx)("code",{className:"px-1.5 py-0.5 bg-zinc-800/50 rounded",children:"ai_usage_log"})]})]}),I>1&&(0,b.jsxs)("div",{className:"flex items-center justify-between border-t border-zinc-800/50 px-4 py-3 bg-zinc-900/50",children:[(0,b.jsxs)("p",{className:"text-xs font-mono text-zinc-500",children:["Page ",(0,b.jsxs)("span",{className:"text-zinc-300",children:[g,"/",I]})," · ",H.toLocaleString()," total"]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[g>1&&(0,b.jsx)(c.default,{href:K({page:String(g-1)}),className:"px-3 py-1.5 text-xs font-mono bg-zinc-800/50 hover:bg-zinc-700/50 text-zinc-300 border border-zinc-700/50 rounded transition-colors",children:"← Prev"}),g<I&&(0,b.jsx)(c.default,{href:K({page:String(g+1)}),className:"px-3 py-1.5 text-xs font-mono bg-zinc-800/50 hover:bg-zinc-700/50 text-zinc-300 border border-zinc-700/50 rounded transition-colors",children:"Next →"})]})]})]})]})}a.s(["default",()=>w],23944)}];

//# sourceMappingURL=src_app_logs_page_tsx_40430ba2._.js.map