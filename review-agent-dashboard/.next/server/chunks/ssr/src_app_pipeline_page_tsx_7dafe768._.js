module.exports=[48210,a=>{"use strict";var b=a.i(7997),c=a.i(95936);function d({stages:a}){let c=a=>{switch(a){case"complete":return{bg:"bg-[var(--success)]/10",border:"border-[var(--success)]",text:"text-[var(--success)]",dot:"bg-[var(--success)]",arrow:"bg-[var(--success)]"};case"in-progress":return{bg:"bg-[var(--primary)]/10",border:"border-[var(--primary)]",text:"text-[var(--primary)]",dot:"bg-[var(--primary)]",arrow:"bg-[var(--primary)]"};case"pending":return{bg:"bg-[var(--muted)]/50",border:"border-[var(--muted)]",text:"text-[var(--muted-foreground)]",dot:"bg-[var(--muted-foreground)]",arrow:"bg-[var(--muted)]"}}},d=a=>{switch(a){case"complete":return"Complete";case"in-progress":return"In Progress";case"pending":return"Pending"}};return(0,b.jsxs)("div",{className:"rounded-xl bg-[var(--card)] border border-[var(--border)] p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-[var(--foreground)] mb-6",children:"Pipeline Flow"}),(0,b.jsx)("div",{className:"flex flex-col lg:flex-row items-stretch lg:items-center gap-4 lg:gap-0",children:a.map((e,f)=>{var g,h;let i=c(e.status),j=(g=e.count,0===(h=e.total)?0:Math.round(g/h*100));return(0,b.jsxs)("div",{className:"flex flex-col lg:flex-row items-center flex-1",children:[(0,b.jsxs)("div",{className:`relative w-full lg:w-auto lg:min-w-[160px] rounded-xl border-2 ${i.border} ${i.bg} p-4 transition-all hover:scale-[1.02]`,children:[(0,b.jsx)("div",{className:"absolute -top-1.5 -right-1.5",children:(0,b.jsx)("div",{className:`h-3 w-3 rounded-full ${i.dot}`,children:"in-progress"===e.status&&(0,b.jsx)("span",{className:"absolute inset-0 rounded-full bg-[var(--primary)] animate-ping opacity-75"})})}),(0,b.jsx)("div",{className:`flex h-10 w-10 items-center justify-center rounded-lg ${i.bg} ${i.text} mb-3`,children:e.icon}),(0,b.jsx)("h4",{className:"font-semibold text-[var(--foreground)]",children:e.name}),(0,b.jsx)("p",{className:"text-xs text-[var(--muted-foreground)] mb-3",children:e.description}),(0,b.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,b.jsx)("span",{className:`text-2xl font-bold ${i.text}`,children:e.count.toLocaleString()}),e.total!==e.count&&(0,b.jsxs)("span",{className:"text-sm text-[var(--muted-foreground)]",children:["/ ",e.total.toLocaleString()]})]}),(0,b.jsx)("div",{className:"mt-3 h-1.5 w-full bg-[var(--secondary)] rounded-full overflow-hidden",children:(0,b.jsx)("div",{className:`h-full ${i.dot} rounded-full transition-all duration-500`,style:{width:`${j}%`}})}),(0,b.jsxs)("p",{className:`mt-2 text-xs font-medium ${i.text}`,children:[d(e.status)," - ",j,"%"]})]}),f<a.length-1&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"hidden lg:flex items-center px-4",children:[(0,b.jsx)("div",{className:`h-0.5 w-8 ${i.arrow}`}),(0,b.jsx)("svg",{className:`w-4 h-4 -ml-1 ${i.text}`,fill:"currentColor",viewBox:"0 0 20 20",children:(0,b.jsx)("path",{fillRule:"evenodd",d:"M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),(0,b.jsxs)("div",{className:"flex lg:hidden items-center justify-center py-2",children:[(0,b.jsx)("div",{className:`w-0.5 h-6 ${i.arrow}`}),(0,b.jsx)("svg",{className:`w-4 h-4 -mt-1 absolute ${i.text}`,fill:"currentColor",viewBox:"0 0 20 20",style:{transform:"rotate(90deg)"},children:(0,b.jsx)("path",{fillRule:"evenodd",d:"M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]})]},e.id)})}),(0,b.jsxs)("div",{className:"mt-6 pt-6 border-t border-[var(--border)]",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm mb-2",children:[(0,b.jsx)("span",{className:"text-[var(--muted-foreground)]",children:"End-to-end Pipeline Progress"}),(0,b.jsxs)("span",{className:"font-medium text-[var(--foreground)]",children:[a.filter(a=>"complete"===a.status).length," of ",a.length," stages complete"]})]}),(0,b.jsx)("div",{className:"flex gap-1",children:a.map(a=>{let e=c(a.status);return(0,b.jsx)("div",{className:`flex-1 h-2 rounded-full ${e.dot}`,title:`${a.name}: ${d(a.status)}`},a.id)})})]})]})}var e=a.i(93133),f=a.i(23878),g=a.i(40905),h=a.i(88588),i=a.i(1508),j=a.i(84674),k=a.i(69713),l=a.i(85791),m=a.i(28407),n=a.i(56603);function o(a){return null===a?"-":a<1e3?`${a}ms`:a<6e4?`${(a/1e3).toFixed(1)}s`:`${Math.round(a/6e4)}m`}async function p(){let[a,c,d,e]=await Promise.all([(0,f.getPipelineStats)(),(0,f.getPipelineTimingStats)(),(0,f.getSearchHistory)({},1,5),(0,f.getContractors)(void 0,1,100)]),k=[],l=e.data.slice().sort((a,b)=>new Date(a.last_synced_at).getTime()-new Date(b.last_synced_at).getTime()),m=l.filter(a=>0===a.reviewCount).slice(0,3),n=l.filter(a=>a.reviewCount>0&&!a.hasAnalysis).slice(0,3),p=l.filter(a=>a.hasAnalysis&&!a.hasArticle).slice(0,3);m.forEach(a=>{k.push({id:a.id,name:a.business_name,city:a.city,state:a.state||"",issue:"no_reviews",lastUpdated:a.last_synced_at})}),n.forEach(a=>{k.push({id:a.id,name:a.business_name,city:a.city,state:a.state||"",issue:"no_analysis",lastUpdated:a.last_synced_at})}),p.forEach(a=>{k.push({id:a.id,name:a.business_name,city:a.city,state:a.state||"",issue:"no_article",lastUpdated:a.last_synced_at})});let q=[{id:"discover",name:"Discover",description:"Find contractors via search",count:a.contractors,total:a.contractors,status:a.contractors>0?"complete":"pending",icon:(0,b.jsx)(g.Search,{className:"h-5 w-5"})},{id:"collect",name:"Collect",description:"Gather reviews from sources",count:a.reviews,total:a.reviews,status:a.reviews>0?"complete":"pending",icon:(0,b.jsx)(h.Star,{className:"h-5 w-5"})},{id:"analyze",name:"Analyze",description:"Run sentiment analysis",count:a.analyses,total:a.contractors,status:a.analyses>=a.contractors?"complete":a.analyses>0?"in-progress":"pending",icon:(0,b.jsx)(i.Lightbulb,{className:"h-5 w-5"})},{id:"generate",name:"Generate",description:"Create article content",count:a.articles,total:a.contractors,status:a.articles>=a.contractors?"complete":a.articles>0?"in-progress":"pending",icon:(0,b.jsx)(j.FileText,{className:"h-5 w-5"})}];return{stages:q,stageDetails:[{id:"discover",name:"Discover",total:a.contractors,success:a.contractors,failed:0,avgTime:o(c.discover.avgDuration),lastRun:c.discover.lastRun||null,totalRuns:c.discover.totalRuns},{id:"collect",name:"Collect",total:a.reviews,success:a.reviews,failed:0,avgTime:"-",lastRun:null,totalRuns:0},{id:"analyze",name:"Analyze",total:a.analyses,success:a.analyses,failed:a.contractors-a.analyses,avgTime:o(c.analyze.avgDuration),lastRun:c.analyze.lastRun||null,totalRuns:c.analyze.totalRuns},{id:"generate",name:"Generate",total:a.articles,success:a.articles,failed:a.contractors-a.articles,avgTime:o(c.generate.avgDuration),lastRun:c.generate.lastRun||null,totalRuns:c.generate.totalRuns}],contractorsNeedingAttention:k,searchHistory:d.data.map(a=>({id:a.id,city:a.city,state:a.state||"",searchTerm:a.search_term,contractorsFound:a.contractors_found||0,timestamp:a.searched_at})),runHistory:[]}}function q(a){if(!a)return"Never";let b=new Date(a),c=Math.floor((new Date().getTime()-b.getTime())/6e4),d=Math.floor(c/60),e=Math.floor(d/24);return c<1?"Just now":c<60?`${c}m ago`:d<24?`${d}h ago`:`${e}d ago`}async function r(){let a=await p(),f={no_reviews:a.contractorsNeedingAttention.filter(a=>"no_reviews"===a.issue),no_analysis:a.contractorsNeedingAttention.filter(a=>"no_analysis"===a.issue),no_article:a.contractorsNeedingAttention.filter(a=>"no_article"===a.issue)},i={no_reviews:"No Reviews Collected",no_analysis:"No Analysis Generated",no_article:"No Article Generated"},j={no_reviews:"text-red-400",no_analysis:"text-amber-400",no_article:"text-cyan-400"},o={no_reviews:"bg-red-500/10 border-red-500/20",no_analysis:"bg-amber-500/10 border-amber-500/20",no_article:"bg-cyan-500/10 border-cyan-500/20"};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(e.PageHeader,{title:"Pipeline Status",subtitle:"Monitor the contractor review analysis pipeline in detail",icon:l.GitBranch,badge:"Live",badgeColor:"emerald"}),(0,b.jsx)(d,{stages:a.stages}),(0,b.jsxs)("div",{className:"bg-zinc-900/30 border border-zinc-800/50 rounded-lg p-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,b.jsx)("div",{className:"h-2 w-2 rounded-full bg-cyan-400 animate-pulse"}),(0,b.jsx)("span",{className:"text-xs font-mono uppercase tracking-wider text-zinc-500",children:"Stage Details"})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:a.stageDetails.map(a=>(0,b.jsxs)("div",{className:"rounded-lg bg-zinc-800/50 border border-zinc-700/50 p-4",children:[(0,b.jsx)("h4",{className:"font-medium text-zinc-200 mb-3",children:a.name}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-zinc-500 font-mono text-xs",children:"Total"}),(0,b.jsx)("span",{className:"font-medium text-zinc-200 font-mono text-xs",children:a.total.toLocaleString()})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-zinc-500 font-mono text-xs",children:"Success"}),(0,b.jsx)("span",{className:"font-medium text-emerald-400 font-mono text-xs",children:a.success.toLocaleString()})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-zinc-500 font-mono text-xs",children:"Failed"}),(0,b.jsx)("span",{className:`font-medium font-mono text-xs ${a.failed>0?"text-red-400":"text-zinc-600"}`,children:a.failed})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-zinc-500 font-mono text-xs",children:"Avg Time"}),(0,b.jsx)("span",{className:"font-medium text-zinc-300 font-mono text-xs",children:a.avgTime})]}),(0,b.jsx)("div",{className:"pt-2 border-t border-zinc-700/50",children:(0,b.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,b.jsx)("span",{className:"text-zinc-600 font-mono",children:"Last Run"}),(0,b.jsx)("span",{className:"text-zinc-500 font-mono",children:a.lastRun?q(a.lastRun):"-"})]})})]})]},a.id))})]}),(0,b.jsxs)("div",{className:"bg-zinc-900/30 border border-zinc-800/50 rounded-lg p-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,b.jsx)(m.AlertTriangle,{className:"h-4 w-4 text-amber-400"}),(0,b.jsx)("span",{className:"text-xs font-mono uppercase tracking-wider text-zinc-500",children:"Contractors Needing Attention"}),(0,b.jsxs)("span",{className:"text-xs font-mono text-zinc-600",children:["(",a.contractorsNeedingAttention.length," total)"]})]}),0===a.contractorsNeedingAttention.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)("div",{className:"inline-flex items-center justify-center h-12 w-12 rounded-full bg-emerald-500/10 border border-emerald-500/20 mb-3",children:(0,b.jsx)(h.Star,{className:"h-5 w-5 text-emerald-400"})}),(0,b.jsx)("p",{className:"text-sm text-zinc-400",children:"All contractors are up to date. No action needed."})]}):(0,b.jsx)("div",{className:"space-y-6",children:Object.entries(f).map(([a,d])=>0===d.length?null:(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,b.jsxs)("span",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-lg text-[10px] font-mono uppercase tracking-widest border ${o[a]} ${j[a]}`,children:[(0,b.jsx)("span",{className:"w-1.5 h-1.5 rounded-full bg-current"}),i[a]]}),(0,b.jsxs)("span",{className:"text-xs text-zinc-600 font-mono",children:[d.length," contractors"]})]}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-zinc-800/50",children:[(0,b.jsx)("th",{className:"text-left py-2 px-3 text-[10px] font-mono uppercase tracking-wider text-zinc-500",children:"Contractor"}),(0,b.jsx)("th",{className:"text-left py-2 px-3 text-[10px] font-mono uppercase tracking-wider text-zinc-500",children:"Location"}),(0,b.jsx)("th",{className:"text-left py-2 px-3 text-[10px] font-mono uppercase tracking-wider text-zinc-500",children:"Last Updated"}),(0,b.jsx)("th",{className:"text-right py-2 px-3 text-[10px] font-mono uppercase tracking-wider text-zinc-500",children:"Action"})]})}),(0,b.jsx)("tbody",{children:d.map(a=>(0,b.jsxs)("tr",{className:"border-b border-zinc-800/30 last:border-b-0 hover:bg-zinc-800/30",children:[(0,b.jsx)("td",{className:"py-2.5 px-3 text-zinc-200 text-sm",children:a.name}),(0,b.jsxs)("td",{className:"py-2.5 px-3 text-zinc-500 font-mono text-xs",children:[a.city,", ",a.state]}),(0,b.jsx)("td",{className:"py-2.5 px-3 text-zinc-500 font-mono text-xs",children:q(a.lastUpdated)}),(0,b.jsx)("td",{className:"py-2.5 px-3 text-right",children:(0,b.jsxs)(c.default,{href:`/contractors/${a.id}`,className:"inline-flex items-center gap-1 text-cyan-400 hover:text-cyan-300 text-xs font-mono transition-colors",children:["View",(0,b.jsx)(k.ExternalLink,{className:"h-3 w-3"})]})})]},a.id))})]})})]},a))})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"bg-zinc-900/30 border border-zinc-800/50 rounded-lg p-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,b.jsx)(g.Search,{className:"h-4 w-4 text-zinc-500"}),(0,b.jsx)("span",{className:"text-xs font-mono uppercase tracking-wider text-zinc-500",children:"Search History"})]}),a.searchHistory.length>0?(0,b.jsxs)("div",{className:"space-y-3",children:[a.searchHistory.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-zinc-800/50 last:border-b-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-lg bg-zinc-800/50 border border-zinc-700/50",children:(0,b.jsx)(g.Search,{className:"h-4 w-4 text-zinc-500"})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-sm font-medium text-zinc-200",children:[a.city,a.state?`, ${a.state}`:""]}),(0,b.jsxs)("p",{className:"text-xs text-zinc-500 font-mono",children:['"',a.searchTerm,'"']})]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("p",{className:"text-sm font-medium text-zinc-200 font-mono",children:[a.contractorsFound," found"]}),(0,b.jsx)("p",{className:"text-xs text-zinc-500 font-mono",children:q(a.timestamp)})]})]},a.id)),(0,b.jsx)(c.default,{href:"/searches",className:"block text-center text-xs font-mono text-cyan-400 hover:text-cyan-300 pt-2 transition-colors",children:"View all searches →"})]}):(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)("div",{className:"inline-flex items-center justify-center h-12 w-12 rounded-full bg-zinc-800/50 border border-zinc-700/50 mb-3",children:(0,b.jsx)(g.Search,{className:"h-5 w-5 text-zinc-600"})}),(0,b.jsx)("p",{className:"text-sm text-zinc-500",children:"No search history available."}),(0,b.jsx)("p",{className:"text-xs text-zinc-600 font-mono mt-1",children:"Run the discover script to populate this data."})]})]}),(0,b.jsxs)("div",{className:"bg-zinc-900/30 border border-zinc-800/50 rounded-lg p-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,b.jsx)(n.Clock,{className:"h-4 w-4 text-zinc-500"}),(0,b.jsx)("span",{className:"text-xs font-mono uppercase tracking-wider text-zinc-500",children:"Run History"})]}),a.runHistory.length>0?(0,b.jsx)("div",{className:"space-y-3",children:a.runHistory.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-zinc-800/50 last:border-b-0",children:[(0,b.jsx)("div",{className:"flex items-center gap-3",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-lg text-[10px] font-mono uppercase tracking-widest border ${{running:"text-cyan-400 bg-cyan-500/10 border-cyan-500/20",completed:"text-emerald-400 bg-emerald-500/10 border-emerald-500/20",failed:"text-red-400 bg-red-500/10 border-red-500/20"}[a.status]}`,children:["running"===a.status&&(0,b.jsx)("span",{className:"w-1.5 h-1.5 rounded-full bg-current animate-pulse"}),{running:"Running",completed:"Completed",failed:"Failed"}[a.status]]}),(0,b.jsx)("span",{className:"text-xs text-zinc-500 font-mono capitalize",children:a.type})]})}),(0,b.jsx)("div",{className:"flex items-center gap-6",children:(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("p",{className:"text-sm text-zinc-200 font-mono",children:[a.contractorsProcessed," processed"]}),a.errors>0&&(0,b.jsxs)("p",{className:"text-xs text-red-400 font-mono",children:[a.errors," errors"]})]})})]},a.id))}):(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)("div",{className:"inline-flex items-center justify-center h-12 w-12 rounded-full bg-zinc-800/50 border border-zinc-700/50 mb-3",children:(0,b.jsx)(n.Clock,{className:"h-5 w-5 text-zinc-600"})}),(0,b.jsx)("p",{className:"text-sm text-zinc-500",children:"Run history is tracked in the Logs page."}),(0,b.jsx)(c.default,{href:"/logs",className:"inline-block mt-2 text-xs font-mono text-cyan-400 hover:text-cyan-300 transition-colors",children:"View execution logs →"})]})]})]})]})}a.s(["default",()=>r],48210)}];

//# sourceMappingURL=src_app_pipeline_page_tsx_7dafe768._.js.map