{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 26, "column": 0}, "map": {"version":3,"sources":["file:///Users/aaronbaker/knearme-workspace/review-agent-dashboard/src/components/dashboard/ArticleCard.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const ArticleCard = registerClientReference(\n    function() { throw new Error(\"Attempted to call ArticleCard() from the server but ArticleCard is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/dashboard/ArticleCard.tsx <module evaluation>\",\n    \"ArticleCard\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;AACO,MAAM,cAAc,IAAA,wQAAuB,EAC9C;IAAa,MAAM,IAAI,MAAM;AAAsO,GACnQ,0EACA","ignoreList":[0]}},
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///Users/aaronbaker/knearme-workspace/review-agent-dashboard/src/components/dashboard/ArticleCard.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const ArticleCard = registerClientReference(\n    function() { throw new Error(\"Attempted to call ArticleCard() from the server but ArticleCard is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/dashboard/ArticleCard.tsx\",\n    \"ArticleCard\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;AACO,MAAM,cAAc,IAAA,wQAAuB,EAC9C;IAAa,MAAM,IAAI,MAAM;AAAsO,GACnQ,sDACA","ignoreList":[0]}},
    {"offset": {"line": 54, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 62, "column": 0}, "map": {"version":3,"sources":["file:///Users/aaronbaker/knearme-workspace/review-agent-dashboard/src/lib/supabase/queries.ts"],"sourcesContent":["/**\n * Supabase query functions for the review-agent-dashboard\n *\n * These functions fetch data from the review_contractors, review_data,\n * review_analysis, and review_articles tables populated by contractor-review-agent.\n *\n * Table naming convention:\n * - review_contractors: Discovered contractors from Google Maps\n * - review_data: Individual reviews collected for each contractor\n * - review_analysis: AI-generated analysis of reviews\n * - review_articles: AI-generated SEO articles\n */\n\nimport { createClient, createAdminClient } from './server';\nimport { unstable_cache } from 'next/cache';\nimport type {\n  DBContractor,\n  DBReview,\n  DBAnalysis,\n  DBArticle,\n  PipelineStats,\n  ContractorFilters,\n  ContractorWithStatus,\n  ArticleWithContractor,\n  AnalysisWithContractor,\n  RecentActivity,\n  ContractorDetail,\n  ArticleFilters,\n  AIUsageLog,\n  AIUsageLogWithContractor,\n  AIUsageStats,\n  AIUsageFilters,\n  SearchedCity,\n  SearchHistoryFilters,\n  DailyCostTrend,\n  ModelStats,\n  PipelineTimingStats,\n} from '../types';\n\nfunction normalizeSearchTerm(input?: string): string | null {\n  if (!input) return null;\n  const sanitized = input.replace(/[(),]/g, ' ').replace(/\\s+/g, ' ').trim();\n  return sanitized.length > 0 ? sanitized : null;\n}\n\n// =============================================================================\n// Pipeline Statistics\n// =============================================================================\n\n/**\n * Get overall pipeline statistics for the dashboard overview\n *\n * @returns Pipeline stats including counts and completion rates\n */\nexport async function getPipelineStats(): Promise<PipelineStats> {\n  const supabase = await createClient();\n\n  // Run all count queries in parallel for efficiency\n  const [\n    contractorsResult,\n    reviewsResult,\n    analysesResult,\n    articlesResult,\n  ] = await Promise.all([\n    supabase.from('review_contractors').select('*', { count: 'exact', head: true }),\n    supabase.from('review_data').select('*', { count: 'exact', head: true }),\n    supabase.from('review_analysis').select('*', { count: 'exact', head: true }),\n    supabase.from('review_articles').select('*', { count: 'exact', head: true }),\n  ]);\n\n  const contractors = contractorsResult.count || 0;\n  const reviews = reviewsResult.count || 0;\n  const analyses = analysesResult.count || 0;\n  const articles = articlesResult.count || 0;\n\n  return {\n    contractors,\n    reviews,\n    analyses,\n    articles,\n    analysisRate: contractors > 0 ? (analyses / contractors) * 100 : 0,\n    articleRate: contractors > 0 ? (articles / contractors) * 100 : 0,\n  };\n}\n\n// =============================================================================\n// Contractor Queries\n// =============================================================================\n\n/**\n * Get paginated list of contractors with their status information\n *\n * @param filters - Optional filter criteria\n * @param page - Page number (1-indexed)\n * @param limit - Items per page\n * @returns Paginated contractors with status flags\n */\nexport async function getContractors(\n  filters?: ContractorFilters,\n  page = 1,\n  limit = 20\n): Promise<{ data: ContractorWithStatus[]; total: number }> {\n  const supabase = await createClient();\n\n  // Dynamic select string construction based on filters\n  let reviewAnalysisSelect = 'review_analysis(id)';\n  let reviewArticlesSelect = 'review_articles(id)';\n\n  if (filters?.hasAnalysis) {\n    reviewAnalysisSelect = 'review_analysis!inner(id)';\n  }\n  if (filters?.hasArticle) {\n    reviewArticlesSelect = 'review_articles!inner(id)';\n  }\n\n  // Build the query with minimal contractor fields and related IDs\n  let query = supabase\n    .from('review_contractors')\n    .select(\n      `\n      id,\n      business_name,\n      rating,\n      review_count,\n      city,\n      state,\n      last_synced_at,\n      ${reviewAnalysisSelect},\n      ${reviewArticlesSelect}\n    `,\n      { count: 'exact' }\n    );\n\n  // Apply basic filters\n  if (filters?.city) {\n    query = query.ilike('city', `%${filters.city}%`);\n  }\n  if (filters?.state) {\n    query = query.eq('state', filters.state);\n  }\n  if (filters?.hasReviews) {\n    query = query.gt('review_count', 0);\n  }\n  if (filters?.minRating !== undefined) {\n    query = query.gte('rating', filters.minRating);\n  }\n  if (filters?.maxRating !== undefined) {\n    query = query.lte('rating', filters.maxRating);\n  }\n  if (filters?.search) {\n    query = query.ilike('business_name', `%${filters.search}%`);\n  }\n\n  // Apply pagination\n  const from = (page - 1) * limit;\n  const to = from + limit - 1;\n  query = query.range(from, to).order('rating', { ascending: false, nullsFirst: false });\n\n  const { data, count, error } = await query;\n\n  if (error) {\n    console.error('Error fetching contractors:', error);\n    throw error;\n  }\n\n  // Transform to ContractorWithStatus\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const contractors: ContractorWithStatus[] = (data || []).map((row: any) => {\n    // Extract contractor fields (exclude nested relations)\n    const { review_analysis, review_articles, review_count, ...contractor } = row;\n\n    return {\n      ...contractor,\n      reviewCount: review_count || 0,\n      hasAnalysis: Array.isArray(review_analysis) && review_analysis.length > 0,\n      hasArticle: Array.isArray(review_articles) && review_articles.length > 0,\n    } as ContractorWithStatus;\n  });\n\n  return {\n    data: contractors,\n    total: count || 0,\n  };\n}\n\n/**\n * Get a single contractor by ID\n *\n * @param id - Contractor UUID\n * @returns Contractor or null if not found\n */\nexport async function getContractorById(id: string): Promise<DBContractor | null> {\n  const supabase = await createClient();\n\n  const { data, error } = await supabase\n    .from('review_contractors')\n    .select('*')\n    .eq('id', id)\n    .single();\n\n  if (error) {\n    if (error.code === 'PGRST116') {\n      // Row not found\n      return null;\n    }\n    console.error('Error fetching contractor:', error);\n    throw error;\n  }\n\n  return data as DBContractor;\n}\n\n/**\n * Get full contractor details including all related data\n *\n * @param id - Contractor UUID\n * @returns Full contractor detail or null if not found\n */\nexport async function getContractorDetail(id: string): Promise<ContractorDetail | null> {\n  const supabase = await createClient();\n\n  // Fetch contractor with all relations\n  const { data, error } = await supabase\n    .from('review_contractors')\n    .select(\n      `\n      *,\n      review_data(*),\n      review_analysis(*),\n      review_articles(*)\n    `\n    )\n    .eq('id', id)\n    .single();\n\n  if (error) {\n    if (error.code === 'PGRST116') {\n      return null;\n    }\n    console.error('Error fetching contractor detail:', error);\n    throw error;\n  }\n\n  if (!data) return null;\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const row = data as any;\n\n  return {\n    ...row,\n    reviews: row.review_data || [],\n    analysis: row.review_analysis?.[0] || null,\n    article: row.review_articles?.[0] || null,\n  } as ContractorDetail;\n}\n\n// =============================================================================\n// Review Queries\n// =============================================================================\n\n/**\n * Get all reviews for a specific contractor\n *\n * @param contractorId - Contractor UUID\n * @returns Array of reviews, ordered by date descending\n */\nexport async function getReviewsByContractor(contractorId: string): Promise<DBReview[]> {\n  const supabase = await createClient();\n\n  const { data, error } = await supabase\n    .from('review_data')\n    .select('*')\n    .eq('contractor_id', contractorId)\n    .order('review_date', { ascending: false, nullsFirst: false });\n\n  if (error) {\n    console.error('Error fetching reviews:', error);\n    throw error;\n  }\n\n  return (data || []) as DBReview[];\n}\n\n/**\n * Get review count by rating for a contractor (for distribution charts)\n *\n * @param contractorId - Contractor UUID\n * @returns Map of rating to count\n */\nexport async function getReviewDistribution(\n  contractorId: string\n): Promise<Record<number, number>> {\n  const supabase = await createClient();\n\n  const { data, error } = await supabase\n    .from('review_data')\n    .select('rating')\n    .eq('contractor_id', contractorId);\n\n  if (error) {\n    console.error('Error fetching review distribution:', error);\n    throw error;\n  }\n\n  // Count by rating\n  const distribution: Record<number, number> = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0 };\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  (data || []).forEach((review: any) => {\n    const rating = Math.round(review.rating);\n    if (rating >= 1 && rating <= 5) {\n      distribution[rating]++;\n    }\n  });\n\n  return distribution;\n}\n\n// =============================================================================\n// Analysis Queries\n// =============================================================================\n\n/**\n * Get analysis for a specific contractor\n *\n * @param contractorId - Contractor UUID\n * @returns Analysis or null if none exists\n */\nexport async function getAnalysisByContractor(contractorId: string): Promise<DBAnalysis | null> {\n  const supabase = await createClient();\n\n  const { data, error } = await supabase\n    .from('review_analysis')\n    .select('*')\n    .eq('contractor_id', contractorId)\n    .order('analyzed_at', { ascending: false })\n    .limit(1)\n    .single();\n\n  if (error) {\n    if (error.code === 'PGRST116') {\n      return null;\n    }\n    console.error('Error fetching analysis:', error);\n    throw error;\n  }\n\n  return data as DBAnalysis;\n}\n\n/**\n * Get all analyses with pagination\n *\n * @param page - Page number (1-indexed)\n * @param limit - Items per page\n * @returns Paginated analyses with contractor data\n */\nexport async function getAnalyses(\n  page = 1,\n  limit = 20\n): Promise<{ data: AnalysisWithContractor[]; total: number }> {\n  const supabase = await createClient();\n\n  const from = (page - 1) * limit;\n  const to = from + limit - 1;\n\n  const { data, count, error } = await supabase\n    .from('review_analysis')\n    .select(\n      `\n      *,\n      contractor:review_contractors(*)\n    `,\n      { count: 'exact' }\n    )\n    .range(from, to)\n    .order('analyzed_at', { ascending: false });\n\n  if (error) {\n    console.error('Error fetching analyses:', error);\n    throw error;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const analyses = (data || []).map((row: any) => ({\n    ...row,\n    contractor: row.contractor,\n  })) as AnalysisWithContractor[];\n\n  return {\n    data: analyses,\n    total: count || 0,\n  };\n}\n\n// =============================================================================\n// Article Queries\n// =============================================================================\n\n/**\n * Get article for a specific contractor\n *\n * @param contractorId - Contractor UUID\n * @returns Article or null if none exists\n */\nexport async function getArticleByContractor(contractorId: string): Promise<DBArticle | null> {\n  const supabase = await createClient();\n\n  const { data, error } = await supabase\n    .from('review_articles')\n    .select('*')\n    .eq('contractor_id', contractorId)\n    .order('generated_at', { ascending: false })\n    .limit(1)\n    .single();\n\n  if (error) {\n    if (error.code === 'PGRST116') {\n      return null;\n    }\n    console.error('Error fetching article:', error);\n    throw error;\n  }\n\n  return data as DBArticle;\n}\n\n/**\n * Get all articles with optional filters, search, sort, and pagination\n *\n * @param filters - Optional filter/search/sort options\n * @param page - Page number (1-indexed)\n * @param limit - Items per page\n * @returns Paginated articles with contractor data\n */\nexport async function getArticles(\n  filters?: ArticleFilters,\n  page = 1,\n  limit = 20\n): Promise<{ data: ArticleWithContractor[]; total: number }> {\n  const supabase = await createClient();\n\n  const from = (page - 1) * limit;\n  const to = from + limit - 1;\n  const searchTerm = normalizeSearchTerm(filters?.search);\n\n  let query = supabase\n    .from('review_articles')\n    .select(\n      `\n      id,\n      title,\n      slug,\n      content_markdown,\n      status,\n      generated_at,\n      contractor:review_contractors(id, business_name, city, state)\n    `,\n      { count: 'exact' }\n    );\n\n  // Apply status filter\n  if (filters?.status) {\n    query = query.eq('status', filters.status);\n  }\n\n  // Apply search filter (searches title and contractor business_name)\n  if (searchTerm) {\n    query = query.or(\n      `title.ilike.%${searchTerm}%,contractor.business_name.ilike.%${searchTerm}%`\n    );\n  }\n\n  // Apply sorting\n  const sortOption = filters?.sort || 'generated_desc';\n  switch (sortOption) {\n    case 'generated_asc':\n      query = query.order('generated_at', { ascending: true });\n      break;\n    case 'title_asc':\n      query = query.order('title', { ascending: true });\n      break;\n    case 'title_desc':\n      query = query.order('title', { ascending: false });\n      break;\n    // For contractor sorting, we'll handle it post-fetch\n    case 'contractor_asc':\n    case 'contractor_desc':\n    case 'generated_desc':\n    default:\n      query = query.order('generated_at', { ascending: false });\n      break;\n  }\n\n  query = query.range(from, to);\n\n  let { data, count, error } = await query;\n\n  if (error && searchTerm) {\n    let fallbackQuery = supabase\n      .from('review_articles')\n      .select(\n        `\n        id,\n        title,\n        slug,\n        content_markdown,\n        status,\n        generated_at,\n        contractor:review_contractors(id, business_name, city, state)\n      `,\n        { count: 'exact' }\n      );\n\n    if (filters?.status) {\n      fallbackQuery = fallbackQuery.eq('status', filters.status);\n    }\n\n    fallbackQuery = fallbackQuery.ilike('title', `%${searchTerm}%`);\n\n    switch (sortOption) {\n      case 'generated_asc':\n        fallbackQuery = fallbackQuery.order('generated_at', { ascending: true });\n        break;\n      case 'title_asc':\n        fallbackQuery = fallbackQuery.order('title', { ascending: true });\n        break;\n      case 'title_desc':\n        fallbackQuery = fallbackQuery.order('title', { ascending: false });\n        break;\n      case 'contractor_asc':\n      case 'contractor_desc':\n      case 'generated_desc':\n      default:\n        fallbackQuery = fallbackQuery.order('generated_at', { ascending: false });\n        break;\n    }\n\n    fallbackQuery = fallbackQuery.range(from, to);\n\n    const fallbackResult = await fallbackQuery;\n    data = fallbackResult.data;\n    count = fallbackResult.count;\n    error = fallbackResult.error;\n  }\n\n  if (error) {\n    console.error('Error fetching articles:', error);\n    throw error;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  let articles = (data || []).map((row: any) => ({\n    ...row,\n    contractor: row.contractor,\n  })) as ArticleWithContractor[];\n\n  // Post-fetch sorting for contractor name\n  if (sortOption === 'contractor_asc') {\n    articles = articles.sort((a, b) =>\n      (a.contractor?.business_name || '').localeCompare(b.contractor?.business_name || '')\n    );\n  } else if (sortOption === 'contractor_desc') {\n    articles = articles.sort((a, b) =>\n      (b.contractor?.business_name || '').localeCompare(a.contractor?.business_name || '')\n    );\n  }\n\n  return {\n    data: articles,\n    total: count || 0,\n  };\n}\n\n/**\n * Get total/published/draft counts for articles with optional search filter\n *\n * @param search - Optional search query (title or contractor name)\n * @returns Aggregate counts for articles\n */\nexport async function getArticleStatusCounts(search?: string): Promise<{\n  total: number;\n  published: number;\n  draft: number;\n}> {\n  const supabase = await createClient();\n  const searchTerm = normalizeSearchTerm(search);\n\n  const buildBaseQuery = (includeContractor: boolean) => {\n    let query = supabase\n      .from('review_articles')\n      .select(\n        includeContractor\n          ? 'id, contractor:review_contractors(id, business_name)'\n          : 'id',\n        {\n          count: 'exact',\n          head: true,\n        }\n      );\n\n    if (searchTerm) {\n      query = includeContractor\n        ? query.or(\n            `title.ilike.%${searchTerm}%,contractor.business_name.ilike.%${searchTerm}%`\n          )\n        : query.ilike('title', `%${searchTerm}%`);\n    }\n\n    return query;\n  };\n\n  const [totalResult, publishedResult, draftResult] = await Promise.all([\n    buildBaseQuery(true),\n    buildBaseQuery(true).eq('status', 'published'),\n    buildBaseQuery(true).eq('status', 'draft'),\n  ]);\n\n  if (totalResult.error || publishedResult.error || draftResult.error) {\n    if (!search) {\n      console.error('Error fetching article status counts:', {\n        total: totalResult.error,\n        published: publishedResult.error,\n        draft: draftResult.error,\n      });\n      return { total: 0, published: 0, draft: 0 };\n    }\n\n    const [fallbackTotal, fallbackPublished, fallbackDraft] = await Promise.all([\n      buildBaseQuery(false),\n      buildBaseQuery(false).eq('status', 'published'),\n      buildBaseQuery(false).eq('status', 'draft'),\n    ]);\n\n    if (\n      fallbackTotal.error ||\n      fallbackPublished.error ||\n      fallbackDraft.error\n    ) {\n      console.error('Error fetching fallback article status counts:', {\n        total: fallbackTotal.error,\n        published: fallbackPublished.error,\n        draft: fallbackDraft.error,\n      });\n      return { total: 0, published: 0, draft: 0 };\n    }\n\n    return {\n      total: fallbackTotal.count || 0,\n      published: fallbackPublished.count || 0,\n      draft: fallbackDraft.count || 0,\n    };\n  }\n\n  return {\n    total: totalResult.count || 0,\n    published: publishedResult.count || 0,\n    draft: draftResult.count || 0,\n  };\n}\n\n/**\n * Get article by ID with contractor data\n *\n * @param id - Article UUID\n * @returns Article with contractor or null if not found\n */\nexport async function getArticleById(id: string): Promise<ArticleWithContractor | null> {\n  const supabase = await createClient();\n\n  const { data, error } = await supabase\n    .from('review_articles')\n    .select(\n      `\n      id,\n      contractor_id,\n      title,\n      slug,\n      content_markdown,\n      metadata_json,\n      model_used,\n      tokens_used,\n      cost_estimate,\n      status,\n      generated_at,\n      contractor:review_contractors(id, business_name, city, state, rating, review_count)\n    `\n    )\n    .eq('id', id)\n    .single();\n\n  if (error) {\n    if (error.code === 'PGRST116') {\n      return null;\n    }\n    console.error('Error fetching article by id:', error);\n    throw error;\n  }\n\n  // Supabase returns contractor as array, extract first element\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const row = data as any;\n  return {\n    ...row,\n    contractor: Array.isArray(row.contractor) ? row.contractor[0] : row.contractor,\n  } as ArticleWithContractor;\n}\n\n/**\n * Get article by slug for public display\n *\n * @param slug - Article URL slug\n * @returns Article with contractor or null\n */\nexport async function getArticleBySlug(slug: string): Promise<ArticleWithContractor | null> {\n  const supabase = await createClient();\n\n  const { data, error } = await supabase\n    .from('review_articles')\n    .select(\n      `\n      id,\n      contractor_id,\n      title,\n      slug,\n      content_markdown,\n      metadata_json,\n      model_used,\n      tokens_used,\n      cost_estimate,\n      status,\n      generated_at,\n      contractor:review_contractors(id, business_name, city, state, rating, review_count)\n    `\n    )\n    .eq('slug', slug)\n    .single();\n\n  if (error) {\n    if (error.code === 'PGRST116') {\n      return null;\n    }\n    console.error('Error fetching article by slug:', error);\n    throw error;\n  }\n\n  // Supabase returns contractor as array, extract first element\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const row = data as any;\n  return {\n    ...row,\n    contractor: Array.isArray(row.contractor) ? row.contractor[0] : row.contractor,\n  } as ArticleWithContractor;\n}\n\n// =============================================================================\n// Reviews Browser Query\n// =============================================================================\n\nexport interface ReviewFilters {\n  rating?: number;\n  search?: string;\n  hasOwnerResponse?: boolean;\n}\n\nexport interface ReviewWithContractor {\n  id: string;\n  contractor_id: string;\n  reviewer_name: string | null;\n  rating: number;\n  review_text: string | null;\n  review_date: string | null;\n  owner_response: string | null;\n  fetched_at: string;\n  contractor: {\n    id: string;\n    business_name: string;\n    city: string | null;\n    state: string | null;\n  } | null;\n}\n\n/**\n * Get all reviews with optional filters and pagination\n * For the /reviews browser page\n *\n * @param filters - Optional filter criteria\n * @param page - Page number (1-indexed)\n * @param limit - Items per page\n * @returns Paginated reviews with contractor data\n */\nexport async function getReviews(\n  filters?: ReviewFilters,\n  page = 1,\n  limit = 20\n): Promise<{ data: ReviewWithContractor[]; total: number; stats: { avgRating: number; responseRate: number } }> {\n  const supabase = await createClient();\n  const searchTerm = normalizeSearchTerm(filters?.search);\n\n  const from = (page - 1) * limit;\n  const to = from + limit - 1;\n\n  let query = supabase\n    .from('review_data')\n    .select(\n      `\n      id,\n      contractor_id,\n      reviewer_name,\n      rating,\n      review_text,\n      review_date,\n      owner_response,\n      fetched_at,\n      contractor:review_contractors(id, business_name, city, state)\n    `,\n      { count: 'exact' }\n    );\n\n  // Apply filters\n  if (filters?.rating) {\n    query = query.eq('rating', filters.rating);\n  }\n  if (searchTerm) {\n    query = query.or(`review_text.ilike.%${searchTerm}%,reviewer_name.ilike.%${searchTerm}%`);\n  }\n  if (filters?.hasOwnerResponse !== undefined) {\n    if (filters.hasOwnerResponse) {\n      query = query.not('owner_response', 'is', null);\n    } else {\n      query = query.is('owner_response', null);\n    }\n  }\n\n  query = query\n    .range(from, to)\n    .order('review_date', { ascending: false, nullsFirst: false });\n\n  const { data, count, error } = await query;\n\n  if (error) {\n    console.error('Error fetching reviews:', error);\n    throw error;\n  }\n\n  // Calculate stats from a separate aggregate query (for all reviews, not just current page)\n  let totalReviews = 0;\n  let sumRatings = 0;\n  let withResponse = 0;\n\n  let statsQuery = supabase\n    .from('review_data')\n    .select('avg_rating:avg(rating), total_reviews:count(*), responses:count(owner_response)');\n\n  if (filters?.rating) {\n    statsQuery = statsQuery.eq('rating', filters.rating);\n  }\n  if (searchTerm) {\n    statsQuery = statsQuery.or(`review_text.ilike.%${searchTerm}%,reviewer_name.ilike.%${searchTerm}%`);\n  }\n  if (filters?.hasOwnerResponse !== undefined) {\n    if (filters.hasOwnerResponse) {\n      statsQuery = statsQuery.not('owner_response', 'is', null);\n    } else {\n      statsQuery = statsQuery.is('owner_response', null);\n    }\n  }\n\n  const { data: statsData, error: statsError } = await statsQuery;\n\n  if (statsError || !statsData || statsData.length === 0) {\n    // Fallback to client-side aggregation if the aggregate query isn't supported\n    let fallbackQuery = supabase\n      .from('review_data')\n      .select('rating, owner_response');\n\n    if (filters?.rating) {\n      fallbackQuery = fallbackQuery.eq('rating', filters.rating);\n    }\n    if (searchTerm) {\n      fallbackQuery = fallbackQuery.or(`review_text.ilike.%${searchTerm}%,reviewer_name.ilike.%${searchTerm}%`);\n    }\n    if (filters?.hasOwnerResponse !== undefined) {\n      if (filters.hasOwnerResponse) {\n        fallbackQuery = fallbackQuery.not('owner_response', 'is', null);\n      } else {\n        fallbackQuery = fallbackQuery.is('owner_response', null);\n      }\n    }\n\n    const fallbackResult = await fallbackQuery;\n\n    const allReviews = fallbackResult.data || [];\n    totalReviews = allReviews.length;\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    sumRatings = allReviews.reduce((sum: number, r: any) => sum + (r.rating || 0), 0);\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    withResponse = allReviews.filter((r: any) => r.owner_response).length;\n  } else {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const stats = statsData[0] as any as {\n      avg_rating: number | null;\n      total_reviews: number | null;\n      responses: number | null;\n    };\n    totalReviews = stats.total_reviews || 0;\n    sumRatings = (stats.avg_rating || 0) * totalReviews;\n    withResponse = stats.responses || 0;\n  }\n\n  // Supabase returns contractor as array, transform to single object\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const reviews = (data || []).map((row: any) => ({\n    ...row,\n    contractor: Array.isArray(row.contractor) ? row.contractor[0] : row.contractor,\n  })) as ReviewWithContractor[];\n\n  return {\n    data: reviews,\n    total: count || 0,\n    stats: {\n      avgRating: totalReviews > 0 ? sumRatings / totalReviews : 0,\n      responseRate: totalReviews > 0 ? (withResponse / totalReviews) * 100 : 0,\n    },\n  };\n}\n\n// =============================================================================\n// Activity & Dashboard Queries\n// =============================================================================\n\n/**\n * Get recent activity across all entities for dashboard display\n *\n * @param limit - Number of items per category\n * @returns Recent contractors, analyses, and articles\n */\nexport async function getRecentActivity(limit = 10): Promise<RecentActivity> {\n  const supabase = await createClient();\n\n  // Fetch all recent items in parallel\n  const [contractorsResult, analysesResult, articlesResult] = await Promise.all([\n    supabase\n      .from('review_contractors')\n      .select('id, business_name, discovered_at')\n      .order('discovered_at', { ascending: false })\n      .limit(limit),\n    supabase\n      .from('review_analysis')\n      .select(\n        `\n        id,\n        analyzed_at,\n        contractor:review_contractors(id, business_name)\n      `\n      )\n      .order('analyzed_at', { ascending: false })\n      .limit(limit),\n    supabase\n      .from('review_articles')\n      .select(\n        `\n        id,\n        generated_at,\n        contractor:review_contractors(id, business_name)\n      `\n      )\n      .order('generated_at', { ascending: false })\n      .limit(limit),\n  ]);\n\n  if (contractorsResult.error) {\n    console.error('Error fetching recent contractors:', contractorsResult.error);\n  }\n  if (analysesResult.error) {\n    console.error('Error fetching recent analyses:', analysesResult.error);\n  }\n  if (articlesResult.error) {\n    console.error('Error fetching recent articles:', articlesResult.error);\n  }\n\n  return {\n    recentContractors: (contractorsResult.data || []) as DBContractor[],\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    recentAnalyses: (analysesResult.data || []).map((row: any) => ({\n      ...row,\n      contractor: row.contractor,\n    })) as AnalysisWithContractor[],\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    recentArticles: (articlesResult.data || []).map((row: any) => ({\n      ...row,\n      contractor: row.contractor,\n    })) as ArticleWithContractor[],\n  };\n}\n\n/**\n * Get unique cities for filter dropdown.\n * Uses RPC function if available (faster), falls back to client-side deduplication.\n *\n * @returns Array of unique city names\n * @see sql/001_performance_optimization.sql - get_unique_cities() RPC function\n */\nexport async function getUniqueCities(): Promise<string[]> {\n  const supabase = await createClient();\n\n  // Try RPC function first (much faster - uses SQL DISTINCT)\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const { data: rpcData, error: rpcError } = await (supabase as any).rpc('get_unique_cities');\n\n  if (!rpcError && rpcData) {\n    // RPC function exists and returned data\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return (rpcData as any[]).map((row: any) => row.city).filter(Boolean);\n  }\n\n  // Fallback: Manual query with client-side deduplication\n  // This path is used before the migration is applied\n  const { data, error } = await supabase\n    .from('review_contractors')\n    .select('city')\n    .order('city');\n\n  if (error) {\n    console.error('Error fetching cities:', error);\n    throw error;\n  }\n\n  // Get unique cities (client-side deduplication)\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const cities = Array.from(new Set((data || []).map((row: any) => row.city)));\n  return cities.filter(Boolean) as string[];\n}\n\n/**\n * Get unique states for filter dropdown.\n * Uses RPC function if available (faster), falls back to client-side deduplication.\n *\n * @returns Array of unique state codes\n * @see sql/001_performance_optimization.sql - get_unique_states() RPC function\n */\nexport async function getUniqueStates(): Promise<string[]> {\n  const supabase = await createClient();\n\n  // Try RPC function first (much faster - uses SQL DISTINCT)\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const { data: rpcData, error: rpcError } = await (supabase as any).rpc('get_unique_states');\n\n  if (!rpcError && rpcData) {\n    // RPC function exists and returned data\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return (rpcData as any[]).map((row: any) => row.state).filter(Boolean);\n  }\n\n  // Fallback: Manual query with client-side deduplication\n  // This path is used before the migration is applied\n  const { data, error } = await supabase\n    .from('review_contractors')\n    .select('state')\n    .order('state');\n\n  if (error) {\n    console.error('Error fetching states:', error);\n    throw error;\n  }\n\n  // Get unique states (client-side deduplication)\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const states = Array.from(new Set((data || []).map((row: any) => row.state)));\n  return states.filter(Boolean) as string[];\n}\n\n/**\n * Cached version of getUniqueCities for filter dropdowns.\n * Caches the result for 1 hour to avoid full table scans on every page load.\n *\n * Uses admin client (no cookies) to work with unstable_cache.\n * Filter options are public data so this is safe.\n *\n * Performance impact: Reduces page load from 500ms-5s to <100ms\n * by eliminating redundant queries for dropdown options.\n *\n * @returns Promise<string[]> - Array of unique city names (cached)\n */\nexport const getCachedCities = unstable_cache(\n  async () => {\n    const supabase = createAdminClient();\n\n    // Try RPC function first (much faster - uses SQL DISTINCT)\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const { data: rpcData, error: rpcError } = await (supabase as any).rpc('get_unique_cities');\n\n    if (!rpcError && rpcData) {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      return (rpcData as any[]).map((row: any) => row.city).filter(Boolean) as string[];\n    }\n\n    // Fallback: Manual query with client-side deduplication\n    const { data, error } = await supabase\n      .from('review_contractors')\n      .select('city')\n      .order('city');\n\n    if (error) {\n      console.error('Error fetching cities:', error);\n      throw error;\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const cities = Array.from(new Set((data || []).map((row: any) => row.city)));\n    return cities.filter(Boolean) as string[];\n  },\n  ['contractor-filter-cities'],\n  { revalidate: 3600, tags: ['contractor-filters'] }\n);\n\n/**\n * Cached version of getUniqueStates for filter dropdowns.\n * Caches the result for 1 hour to avoid full table scans on every page load.\n *\n * Uses admin client (no cookies) to work with unstable_cache.\n * Filter options are public data so this is safe.\n *\n * @returns Promise<string[]> - Array of unique state codes (cached)\n */\nexport const getCachedStates = unstable_cache(\n  async () => {\n    const supabase = createAdminClient();\n\n    // Try RPC function first (much faster - uses SQL DISTINCT)\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const { data: rpcData, error: rpcError } = await (supabase as any).rpc('get_unique_states');\n\n    if (!rpcError && rpcData) {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      return (rpcData as any[]).map((row: any) => row.state).filter(Boolean) as string[];\n    }\n\n    // Fallback: Manual query with client-side deduplication\n    const { data, error } = await supabase\n      .from('review_contractors')\n      .select('state')\n      .order('state');\n\n    if (error) {\n      console.error('Error fetching states:', error);\n      throw error;\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const states = Array.from(new Set((data || []).map((row: any) => row.state)));\n    return states.filter(Boolean) as string[];\n  },\n  ['contractor-filter-states'],\n  { revalidate: 3600, tags: ['contractor-filters'] }\n);\n\n// =============================================================================\n// Search Queries\n// =============================================================================\n\n/**\n * Search contractors by business name\n *\n * @param query - Search string\n * @param limit - Max results\n * @returns Matching contractors\n */\nexport async function searchContractors(\n  query: string,\n  limit = 10\n): Promise<ContractorWithStatus[]> {\n  const supabase = await createClient();\n\n  const { data, error } = await supabase\n    .from('review_contractors')\n    .select(\n      `\n      *,\n      review_data(id),\n      review_analysis(id),\n      review_articles(id)\n    `\n    )\n    .ilike('business_name', `%${query}%`)\n    .order('rating', { ascending: false, nullsFirst: false })\n    .limit(limit);\n\n  if (error) {\n    console.error('Error searching contractors:', error);\n    throw error;\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  return (data || []).map((row: any) => {\n    const { review_data, review_analysis, review_articles, ...contractor } = row;\n    return {\n      ...contractor,\n      reviewCount: Array.isArray(review_data) ? review_data.length : 0,\n      hasAnalysis: Array.isArray(review_analysis) && review_analysis.length > 0,\n      hasArticle: Array.isArray(review_articles) && review_articles.length > 0,\n    } as ContractorWithStatus;\n  });\n}\n\n// =============================================================================\n// AI Usage & Cost Tracking Queries\n// =============================================================================\n\n/**\n * Get aggregated AI usage statistics\n *\n * @param filters - Optional filters (date range, operation type)\n * @returns Aggregated statistics\n */\nexport async function getAIUsageStats(filters?: AIUsageFilters): Promise<AIUsageStats> {\n  const supabase = await createClient();\n\n  let query = supabase\n    .from('ai_usage_log')\n    .select('operation, total_tokens, cost_estimate, success');\n\n  // Apply filters\n  if (filters?.operation) {\n    query = query.eq('operation', filters.operation);\n  }\n  if (filters?.success !== undefined) {\n    query = query.eq('success', filters.success);\n  }\n  if (filters?.since) {\n    query = query.gte('created_at', filters.since);\n  }\n  if (filters?.until) {\n    query = query.lte('created_at', filters.until);\n  }\n\n  const { data, error } = await query;\n\n  if (error) {\n    console.error('Error fetching AI usage stats:', error);\n    // Return empty stats if table doesn't exist yet\n    return {\n      totalOperations: 0,\n      totalTokens: 0,\n      totalInputTokens: 0,\n      totalOutputTokens: 0,\n      totalCost: 0,\n      avgCostPerOperation: 0,\n      avgTokensPerOperation: 0,\n      byOperation: {\n        analyze: { count: 0, tokens: 0, inputTokens: 0, outputTokens: 0, cost: 0 },\n        generate: { count: 0, tokens: 0, inputTokens: 0, outputTokens: 0, cost: 0 },\n        discover: { count: 0, tokens: 0, inputTokens: 0, outputTokens: 0, cost: 0 },\n      },\n      successRate: 0,\n    };\n  }\n\n  const logs = (data || []) as AIUsageLog[];\n\n  // Calculate aggregations\n  const totalOperations = logs.length;\n  const totalTokens = logs.reduce((sum, log) => sum + (log.total_tokens || 0), 0);\n  const totalInputTokens = logs.reduce((sum, log) => sum + (log.input_tokens || 0), 0);\n  const totalOutputTokens = logs.reduce((sum, log) => sum + (log.output_tokens || 0), 0);\n  const totalCost = logs.reduce((sum, log) => sum + Number(log.cost_estimate || 0), 0);\n  const successfulOps = logs.filter((log) => log.success).length;\n\n  // Group by operation\n  const byOperation = {\n    analyze: { count: 0, tokens: 0, inputTokens: 0, outputTokens: 0, cost: 0 },\n    generate: { count: 0, tokens: 0, inputTokens: 0, outputTokens: 0, cost: 0 },\n    discover: { count: 0, tokens: 0, inputTokens: 0, outputTokens: 0, cost: 0 },\n  };\n\n  logs.forEach((log) => {\n    const op = log.operation as keyof typeof byOperation;\n    if (byOperation[op]) {\n      byOperation[op].count++;\n      byOperation[op].tokens += log.total_tokens || 0;\n      byOperation[op].inputTokens += log.input_tokens || 0;\n      byOperation[op].outputTokens += log.output_tokens || 0;\n      byOperation[op].cost += Number(log.cost_estimate || 0);\n    }\n  });\n\n  return {\n    totalOperations,\n    totalTokens,\n    totalInputTokens,\n    totalOutputTokens,\n    totalCost,\n    avgCostPerOperation: totalOperations > 0 ? totalCost / totalOperations : 0,\n    avgTokensPerOperation: totalOperations > 0 ? totalTokens / totalOperations : 0,\n    byOperation,\n    successRate: totalOperations > 0 ? (successfulOps / totalOperations) * 100 : 0,\n  };\n}\n\n/**\n * Get paginated AI usage logs\n *\n * @param filters - Optional filters\n * @param page - Page number (1-indexed)\n * @param limit - Items per page\n * @returns Paginated logs with contractor data\n */\nexport type LogSortColumn = 'created_at' | 'total_tokens' | 'cost_estimate' | 'duration_ms';\n\nexport async function getAIUsageLogs(\n  filters?: AIUsageFilters,\n  page = 1,\n  limit = 50,\n  sortColumn: LogSortColumn = 'created_at',\n  sortOrder: 'asc' | 'desc' = 'desc'\n): Promise<{ data: AIUsageLogWithContractor[]; total: number }> {\n  const supabase = await createClient();\n\n  const from = (page - 1) * limit;\n  const to = from + limit - 1;\n\n  let query = supabase\n    .from('ai_usage_log')\n    .select(\n      `\n      *,\n      contractor:review_contractors(id, business_name, city, state)\n    `,\n      { count: 'exact' }\n    );\n\n  // Apply filters\n  if (filters?.operation) {\n    query = query.eq('operation', filters.operation);\n  }\n  if (filters?.success !== undefined) {\n    query = query.eq('success', filters.success);\n  }\n  if (filters?.since) {\n    query = query.gte('created_at', filters.since);\n  }\n  if (filters?.until) {\n    query = query.lte('created_at', filters.until);\n  }\n\n  // Apply sorting - validate column name to prevent injection\n  const validColumns: LogSortColumn[] = ['created_at', 'total_tokens', 'cost_estimate', 'duration_ms'];\n  const safeColumn = validColumns.includes(sortColumn) ? sortColumn : 'created_at';\n\n  query = query.range(from, to).order(safeColumn, { ascending: sortOrder === 'asc' });\n\n  const { data, count, error } = await query;\n\n  if (error) {\n    console.error('Error fetching AI usage logs:', error);\n    return { data: [], total: 0 };\n  }\n\n  return {\n    data: (data || []) as AIUsageLogWithContractor[],\n    total: count || 0,\n  };\n}\n\n/**\n * Get cost breakdown by contractor\n *\n * @param contractorId - Contractor UUID\n * @returns Total cost and token usage for this contractor\n */\nexport async function getCostByContractor(contractorId: string): Promise<{\n  totalCost: number;\n  totalTokens: number;\n  operations: number;\n}> {\n  const supabase = await createClient();\n\n  const { data, error } = await supabase\n    .from('ai_usage_log')\n    .select('total_tokens, cost_estimate')\n    .eq('contractor_id', contractorId);\n\n  if (error) {\n    console.error('Error fetching contractor costs:', error);\n    return { totalCost: 0, totalTokens: 0, operations: 0 };\n  }\n\n  const logs = data || [];\n  return {\n    totalCost: logs.reduce((sum, log) => sum + Number(log.cost_estimate || 0), 0),\n    totalTokens: logs.reduce((sum, log) => sum + (log.total_tokens || 0), 0),\n    operations: logs.length,\n  };\n}\n\n/**\n * Get daily cost trend for the specified number of days\n *\n * @param days - Number of days to look back\n * @returns Array of daily cost data points\n */\nexport async function getDailyCostTrend(days = 30): Promise<DailyCostTrend[]> {\n  const supabase = await createClient();\n\n  const since = new Date();\n  since.setDate(since.getDate() - days);\n\n  const { data, error } = await supabase\n    .from('ai_usage_log')\n    .select('created_at, total_tokens, cost_estimate')\n    .gte('created_at', since.toISOString())\n    .order('created_at', { ascending: true });\n\n  if (error) {\n    console.error('Error fetching daily cost trend:', error);\n    return [];\n  }\n\n  // Group by date\n  const byDate: Record<string, DailyCostTrend> = {};\n\n  (data || []).forEach((log) => {\n    const date = log.created_at.split('T')[0];\n    if (!byDate[date]) {\n      byDate[date] = { date, cost: 0, tokens: 0, operations: 0 };\n    }\n    byDate[date].cost += Number(log.cost_estimate || 0);\n    byDate[date].tokens += log.total_tokens || 0;\n    byDate[date].operations++;\n  });\n\n  return Object.values(byDate).sort((a, b) => a.date.localeCompare(b.date));\n}\n\n/**\n * Get model performance statistics\n *\n * @returns Stats grouped by model\n */\nexport async function getModelStats(): Promise<ModelStats[]> {\n  const supabase = await createClient();\n\n  const { data, error } = await supabase\n    .from('ai_usage_log')\n    .select('model, total_tokens, cost_estimate, duration_ms, success');\n\n  if (error) {\n    console.error('Error fetching model stats:', error);\n    return [];\n  }\n\n  // Group by model\n  const byModel: Record<string, {\n    totalOps: number;\n    totalTokens: number;\n    totalCost: number;\n    totalDuration: number;\n    successCount: number;\n    durationCount: number;\n  }> = {};\n\n  (data || []).forEach((log) => {\n    const model = log.model || 'unknown';\n    if (!byModel[model]) {\n      byModel[model] = {\n        totalOps: 0,\n        totalTokens: 0,\n        totalCost: 0,\n        totalDuration: 0,\n        successCount: 0,\n        durationCount: 0,\n      };\n    }\n    byModel[model].totalOps++;\n    byModel[model].totalTokens += log.total_tokens || 0;\n    byModel[model].totalCost += Number(log.cost_estimate || 0);\n    if (log.duration_ms) {\n      byModel[model].totalDuration += log.duration_ms;\n      byModel[model].durationCount++;\n    }\n    if (log.success) {\n      byModel[model].successCount++;\n    }\n  });\n\n  return Object.entries(byModel).map(([model, stats]) => ({\n    model,\n    totalOperations: stats.totalOps,\n    totalTokens: stats.totalTokens,\n    totalCost: stats.totalCost,\n    avgDuration: stats.durationCount > 0 ? stats.totalDuration / stats.durationCount : 0,\n    successRate: stats.totalOps > 0 ? (stats.successCount / stats.totalOps) * 100 : 0,\n  }));\n}\n\n/**\n * Duration distribution buckets\n */\nexport interface DurationBucket {\n  label: string\n  min: number\n  max: number\n  count: number\n}\n\n/**\n * Get duration distribution for histogram\n *\n * @param filters - Optional filters (date range, operation type)\n * @returns Array of duration buckets with counts\n */\nexport async function getDurationDistribution(filters?: AIUsageFilters): Promise<DurationBucket[]> {\n  const supabase = await createClient();\n\n  let query = supabase\n    .from('ai_usage_log')\n    .select('duration_ms')\n    .not('duration_ms', 'is', null);\n\n  // Apply filters\n  if (filters?.operation) {\n    query = query.eq('operation', filters.operation);\n  }\n  if (filters?.success !== undefined) {\n    query = query.eq('success', filters.success);\n  }\n  if (filters?.since) {\n    query = query.gte('created_at', filters.since);\n  }\n  if (filters?.until) {\n    query = query.lte('created_at', filters.until);\n  }\n\n  const { data, error } = await query;\n\n  if (error) {\n    console.error('Error fetching duration distribution:', error);\n    return [];\n  }\n\n  // Define buckets: <1s, 1-3s, 3-5s, 5-10s, 10-30s, 30s+\n  const buckets: DurationBucket[] = [\n    { label: '<1s', min: 0, max: 1000, count: 0 },\n    { label: '1-3s', min: 1000, max: 3000, count: 0 },\n    { label: '3-5s', min: 3000, max: 5000, count: 0 },\n    { label: '5-10s', min: 5000, max: 10000, count: 0 },\n    { label: '10-30s', min: 10000, max: 30000, count: 0 },\n    { label: '30s+', min: 30000, max: Infinity, count: 0 },\n  ];\n\n  // Count operations per bucket\n  (data || []).forEach((log) => {\n    const duration = log.duration_ms as number;\n    for (const bucket of buckets) {\n      if (duration >= bucket.min && duration < bucket.max) {\n        bucket.count++;\n        break;\n      }\n    }\n  });\n\n  return buckets;\n}\n\n/**\n * Get top contractors by total cost\n *\n * @param limit - Number of contractors to return\n * @returns Array of contractors sorted by total cost descending\n */\nexport async function getTopContractorsByCost(limit = 10): Promise<{\n  contractor_id: string;\n  business_name: string;\n  city: string | null;\n  state: string | null;\n  totalCost: number;\n  totalTokens: number;\n  totalOperations: number;\n}[]> {\n  const supabase = await createClient();\n\n  // Fetch all logs with contractor data\n  const { data, error } = await supabase\n    .from('ai_usage_log')\n    .select(`\n      contractor_id,\n      total_tokens,\n      cost_estimate,\n      contractor:review_contractors(id, business_name, city, state)\n    `)\n    .not('contractor_id', 'is', null);\n\n  if (error) {\n    console.error('Error fetching top contractors by cost:', error);\n    return [];\n  }\n\n  // Group by contractor\n  const byContractor: Record<string, {\n    contractor_id: string;\n    business_name: string;\n    city: string | null;\n    state: string | null;\n    totalCost: number;\n    totalTokens: number;\n    totalOperations: number;\n  }> = {};\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  (data || []).forEach((log: any) => {\n    const contractorId = log.contractor_id;\n    if (!contractorId || !log.contractor) return;\n\n    if (!byContractor[contractorId]) {\n      byContractor[contractorId] = {\n        contractor_id: contractorId,\n        business_name: log.contractor.business_name || 'Unknown',\n        city: log.contractor.city,\n        state: log.contractor.state,\n        totalCost: 0,\n        totalTokens: 0,\n        totalOperations: 0,\n      };\n    }\n\n    byContractor[contractorId].totalCost += Number(log.cost_estimate || 0);\n    byContractor[contractorId].totalTokens += log.total_tokens || 0;\n    byContractor[contractorId].totalOperations++;\n  });\n\n  // Sort by cost descending and limit\n  return Object.values(byContractor)\n    .sort((a, b) => b.totalCost - a.totalCost)\n    .slice(0, limit);\n}\n\n// =============================================================================\n// Search History Queries\n// =============================================================================\n\n/**\n * Get search history (discovery searches)\n *\n * @param filters - Optional filters\n * @param page - Page number (1-indexed)\n * @param limit - Items per page\n * @returns Paginated search history\n */\nexport type SearchSortColumn = 'searched_at' | 'contractors_found' | 'city';\n\nexport async function getSearchHistory(\n  filters?: SearchHistoryFilters,\n  page = 1,\n  limit = 50,\n  sortColumn: SearchSortColumn = 'searched_at',\n  sortOrder: 'asc' | 'desc' = 'desc'\n): Promise<{ data: SearchedCity[]; total: number }> {\n  const supabase = await createClient();\n\n  const from = (page - 1) * limit;\n  const to = from + limit - 1;\n\n  let query = supabase.from('searched_cities').select('*', { count: 'exact' });\n\n  // Apply filters\n  if (filters?.city) {\n    query = query.ilike('city', `%${filters.city}%`);\n  }\n  if (filters?.state) {\n    query = query.eq('state', filters.state);\n  }\n  if (filters?.searchTerm) {\n    query = query.ilike('search_term', `%${filters.searchTerm}%`);\n  }\n\n  // Apply sorting - validate column name\n  const validColumns: SearchSortColumn[] = ['searched_at', 'contractors_found', 'city'];\n  const safeColumn = validColumns.includes(sortColumn) ? sortColumn : 'searched_at';\n\n  query = query.range(from, to).order(safeColumn, { ascending: sortOrder === 'asc' });\n\n  const { data, count, error } = await query;\n\n  if (error) {\n    console.error('Error fetching search history:', error);\n    return { data: [], total: 0 };\n  }\n\n  return {\n    data: (data || []) as SearchedCity[],\n    total: count || 0,\n  };\n}\n\n/**\n * Get search history summary stats\n *\n * @returns Summary of searches\n */\nexport async function getSearchHistoryStats(): Promise<{\n  totalSearches: number;\n  totalContractorsFound: number;\n  uniqueCities: number;\n  uniqueStates: number;\n}> {\n  const supabase = await createClient();\n\n  const { data, error } = await supabase\n    .from('searched_cities')\n    .select('city, state, contractors_found');\n\n  if (error) {\n    console.error('Error fetching search history stats:', error);\n    return {\n      totalSearches: 0,\n      totalContractorsFound: 0,\n      uniqueCities: 0,\n      uniqueStates: 0,\n    };\n  }\n\n  const searches = data || [];\n  const cities = new Set(searches.map((s) => s.city));\n  const states = new Set(searches.map((s) => s.state).filter(Boolean));\n\n  return {\n    totalSearches: searches.length,\n    totalContractorsFound: searches.reduce((sum, s) => sum + (s.contractors_found || 0), 0),\n    uniqueCities: cities.size,\n    uniqueStates: states.size,\n  };\n}\n\n/**\n * Get duplicate search combos (city + search_term appearing more than once)\n *\n * @returns Set of duplicate keys (city|state|search_term)\n */\nexport async function getDuplicateSearches(): Promise<Set<string>> {\n  const supabase = await createClient();\n\n  const { data, error } = await supabase\n    .from('searched_cities')\n    .select('city, state, search_term');\n\n  if (error) {\n    console.error('Error fetching searches for duplicates:', error);\n    return new Set();\n  }\n\n  // Count occurrences\n  const counts: Record<string, number> = {};\n  (data || []).forEach((search) => {\n    const key = `${search.city}|${search.state || ''}|${search.search_term}`;\n    counts[key] = (counts[key] || 0) + 1;\n  });\n\n  // Return keys with count > 1\n  const duplicates = new Set<string>();\n  Object.entries(counts).forEach(([key, count]) => {\n    if (count > 1) {\n      duplicates.add(key);\n    }\n  });\n\n  return duplicates;\n}\n\n// =============================================================================\n// Optimized Search History Queries (Scalable)\n// =============================================================================\n\n/**\n * Scalable stats query using SQL aggregates instead of full table scan.\n * Returns stats in O(1) time with proper indexes vs O(N) for client-side.\n *\n * @param filters - Optional filters to scope stats\n * @returns Aggregated search statistics\n */\nexport async function getSearchStatsOptimized(filters?: SearchHistoryFilters): Promise<{\n  totalSearches: number;\n  totalContractorsFound: number;\n  uniqueCities: number;\n  uniqueStates: number;\n}> {\n  const supabase = await createClient();\n\n  // Build filtered query - Supabase doesn't support aggregate functions directly,\n  // so we use select with count option for total and separate DISTINCT queries\n  let query = supabase.from('searched_cities').select('*', { count: 'exact', head: true });\n\n  if (filters?.city) {\n    query = query.eq('city', filters.city);\n  }\n  if (filters?.state) {\n    query = query.eq('state', filters.state);\n  }\n\n  // Get total count\n  const { count: totalSearches, error: countError } = await query;\n\n  if (countError) {\n    console.error('Error fetching search stats:', countError);\n    return { totalSearches: 0, totalContractorsFound: 0, uniqueCities: 0, uniqueStates: 0 };\n  }\n\n  // Get sum of contractors_found and distinct counts with separate optimized queries\n  // These use DISTINCT which PostgreSQL optimizes with indexes\n  let sumQuery = supabase.from('searched_cities').select('contractors_found');\n  let cityQuery = supabase.from('searched_cities').select('city');\n  let stateQuery = supabase.from('searched_cities').select('state');\n\n  if (filters?.city) {\n    sumQuery = sumQuery.eq('city', filters.city);\n    cityQuery = cityQuery.eq('city', filters.city);\n    stateQuery = stateQuery.eq('city', filters.city);\n  }\n  if (filters?.state) {\n    sumQuery = sumQuery.eq('state', filters.state);\n    cityQuery = cityQuery.eq('state', filters.state);\n    stateQuery = stateQuery.eq('state', filters.state);\n  }\n\n  const [sumResult, cityResult, stateResult] = await Promise.all([\n    sumQuery,\n    cityQuery,\n    stateQuery,\n  ]);\n\n  // Calculate sum client-side (unavoidable without RPC, but limited by filters)\n  const totalContractorsFound = (sumResult.data || []).reduce(\n    (sum, row) => sum + (row.contractors_found || 0),\n    0\n  );\n\n  // Use Set for distinct counts (fast for filtered results)\n  const uniqueCities = new Set((cityResult.data || []).map((r) => r.city)).size;\n  const uniqueStates = new Set(\n    (stateResult.data || []).map((r) => r.state).filter(Boolean)\n  ).size;\n\n  return {\n    totalSearches: totalSearches || 0,\n    totalContractorsFound,\n    uniqueCities,\n    uniqueStates,\n  };\n}\n\n/**\n * Get global filter options for the searches page.\n * Fetches ALL distinct cities and states so filters work across pages.\n *\n * @returns Object with arrays of unique states and cities\n */\nexport async function getGlobalFilterOptions(): Promise<{\n  states: string[];\n  cities: string[];\n}> {\n  const supabase = await createClient();\n\n  // Fetch distinct values - PostgreSQL optimizes DISTINCT with indexes\n  const [statesResult, citiesResult] = await Promise.all([\n    supabase.from('searched_cities').select('state').order('state'),\n    supabase.from('searched_cities').select('city').order('city').limit(500),\n  ]);\n\n  // Extract unique values (dedupe in case of missing DISTINCT support)\n  const states = [\n    ...new Set(\n      (statesResult.data || [])\n        .map((r) => r.state)\n        .filter((s): s is string => Boolean(s))\n    ),\n  ].sort();\n\n  const cities = [\n    ...new Set((citiesResult.data || []).map((r) => r.city)),\n  ].sort();\n\n  return { states, cities };\n}\n\n/**\n * Database-optimized duplicate detection using GROUP BY HAVING.\n * Returns array of duplicate keys instead of loading entire dataset.\n *\n * Since Supabase JS client doesn't support GROUP BY HAVING directly,\n * we use a workaround: fetch grouped data and filter.\n *\n * @returns Array of duplicate \"city|state|search_term\" keys\n */\nexport async function getDuplicateKeysOptimized(): Promise<string[]> {\n  const supabase = await createClient();\n\n  // Fetch minimal data needed for duplicate detection\n  // Limit to reasonable amount for scalability\n  const { data, error } = await supabase\n    .from('searched_cities')\n    .select('city, state, search_term')\n    .limit(10000); // Safety limit\n\n  if (error) {\n    console.error('Error fetching duplicates:', error);\n    return [];\n  }\n\n  // Count occurrences efficiently\n  const counts: Record<string, number> = {};\n  for (const search of data || []) {\n    const key = `${search.city}|${search.state || ''}|${search.search_term}`;\n    counts[key] = (counts[key] || 0) + 1;\n  }\n\n  // Return only duplicate keys\n  return Object.entries(counts)\n    .filter(([, count]) => count > 1)\n    .map(([key]) => key);\n}\n\n// =============================================================================\n// Pipeline Timing Queries\n// =============================================================================\n\n/**\n * Get real pipeline timing statistics from ai_usage_log\n *\n * @returns Timing stats for each pipeline stage\n */\nexport async function getPipelineTimingStats(): Promise<PipelineTimingStats> {\n  const supabase = await createClient();\n\n  // Fetch all logs to calculate timing stats\n  const { data, error } = await supabase\n    .from('ai_usage_log')\n    .select('operation, duration_ms, created_at')\n    .order('created_at', { ascending: false });\n\n  if (error) {\n    console.error('Error fetching pipeline timing:', error);\n    return {\n      discover: { avgDuration: null, lastRun: null, totalRuns: 0 },\n      analyze: { avgDuration: null, lastRun: null, totalRuns: 0 },\n      generate: { avgDuration: null, lastRun: null, totalRuns: 0 },\n    };\n  }\n\n  const logs = data || [];\n\n  // Helper to calculate stats for an operation type\n  const calcStats = (operation: string) => {\n    const opLogs = logs.filter((l) => l.operation === operation);\n    const withDuration = opLogs.filter((l) => l.duration_ms);\n    const totalDuration = withDuration.reduce((sum, l) => sum + (l.duration_ms || 0), 0);\n\n    return {\n      avgDuration: withDuration.length > 0 ? Math.round(totalDuration / withDuration.length) : null,\n      lastRun: opLogs.length > 0 ? opLogs[0].created_at : null,\n      totalRuns: opLogs.length,\n    };\n  };\n\n  return {\n    discover: calcStats('discover'),\n    analyze: calcStats('analyze'),\n    generate: calcStats('generate'),\n  };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1481, "column": 0}, "map": {"version":3,"sources":["file:///Users/aaronbaker/knearme-workspace/review-agent-dashboard/src/components/dashboard/PageHeader.tsx"],"sourcesContent":["import type { LucideIcon } from 'lucide-react'\nimport { Database } from 'lucide-react'\n\n/**\n * PageHeader - Mission Control style page header\n *\n * Consistent header pattern with icon, title, optional status badge,\n * subtitle, and database table reference.\n *\n * @example\n * <PageHeader\n *   title=\"Search History\"\n *   subtitle=\"Google Maps discovery operations\"\n *   icon={Activity}\n *   badge=\"Live\"\n *   badgeColor=\"emerald\"\n *   recordCount={1234}\n *   tableName=\"searched_cities\"\n * />\n */\n\ntype BadgeColor = 'emerald' | 'amber' | 'cyan' | 'violet' | 'red' | 'blue'\n\ninterface PageHeaderProps {\n  title: string\n  subtitle?: string\n  icon?: LucideIcon\n  /** Optional status badge text (e.g., \"Live\", \"Beta\") */\n  badge?: string\n  badgeColor?: BadgeColor\n  /** Total record count to display */\n  recordCount?: number\n  /** Database table name for reference badge */\n  tableName?: string\n  /** Right-side content slot */\n  actions?: React.ReactNode\n}\n\nconst badgeColors: Record<BadgeColor, string> = {\n  emerald: 'text-emerald-400 bg-emerald-500/10 border-emerald-500/20',\n  amber: 'text-amber-400 bg-amber-500/10 border-amber-500/20',\n  cyan: 'text-cyan-400 bg-cyan-500/10 border-cyan-500/20',\n  violet: 'text-violet-400 bg-violet-500/10 border-violet-500/20',\n  red: 'text-red-400 bg-red-500/10 border-red-500/20',\n  blue: 'text-blue-400 bg-blue-500/10 border-blue-500/20',\n}\n\nexport function PageHeader({\n  title,\n  subtitle,\n  icon: Icon,\n  badge,\n  badgeColor = 'emerald',\n  recordCount,\n  tableName,\n  actions,\n}: PageHeaderProps) {\n  return (\n    <div className=\"flex items-start justify-between\">\n      <div>\n        <div className=\"flex items-center gap-3 mb-1\">\n          <div className=\"flex items-center gap-2\">\n            {Icon && <Icon className=\"h-5 w-5 text-emerald-400\" />}\n            <h1 className=\"text-2xl font-bold text-zinc-100 tracking-tight\">\n              {title}\n            </h1>\n          </div>\n          {badge && (\n            <span\n              className={`px-2 py-0.5 text-[10px] font-mono uppercase tracking-widest border rounded ${badgeColors[badgeColor]}`}\n            >\n              {badge}\n            </span>\n          )}\n        </div>\n        {(subtitle || recordCount !== undefined) && (\n          <p className=\"text-sm text-zinc-500 font-mono\">\n            {subtitle}\n            {subtitle && recordCount !== undefined && ' \\u00B7 '}\n            {recordCount !== undefined && `${recordCount.toLocaleString()} records`}\n          </p>\n        )}\n      </div>\n\n      <div className=\"flex items-center gap-3\">\n        {actions}\n        {tableName && (\n          <div className=\"flex items-center gap-2 px-3 py-1.5 bg-zinc-900/50 border border-zinc-800/50 rounded-lg\">\n            <Database className=\"h-4 w-4 text-zinc-500\" />\n            <span className=\"text-xs font-mono text-zinc-500\">{tableName}</span>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AACA;;;AAqCA,MAAM,cAA0C;IAC9C,SAAS;IACT,OAAO;IACP,MAAM;IACN,QAAQ;IACR,KAAK;IACL,MAAM;AACR;AAEO,SAAS,WAAW,EACzB,KAAK,EACL,QAAQ,EACR,MAAM,IAAI,EACV,KAAK,EACL,aAAa,SAAS,EACtB,WAAW,EACX,SAAS,EACT,OAAO,EACS;IAChB,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;;kCACC,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;;oCACZ,sBAAQ,8OAAC;wCAAK,WAAU;;;;;;kDACzB,8OAAC;wCAAG,WAAU;kDACX;;;;;;;;;;;;4BAGJ,uBACC,8OAAC;gCACC,WAAW,CAAC,2EAA2E,EAAE,WAAW,CAAC,WAAW,EAAE;0CAEjH;;;;;;;;;;;;oBAIN,CAAC,YAAY,gBAAgB,SAAS,mBACrC,8OAAC;wBAAE,WAAU;;4BACV;4BACA,YAAY,gBAAgB,aAAa;4BACzC,gBAAgB,aAAa,GAAG,YAAY,cAAc,GAAG,QAAQ,CAAC;;;;;;;;;;;;;0BAK7E,8OAAC;gBAAI,WAAU;;oBACZ;oBACA,2BACC,8OAAC;wBAAI,WAAU;;0CACb,8OAAC,sNAAQ;gCAAC,WAAU;;;;;;0CACpB,8OAAC;gCAAK,WAAU;0CAAmC;;;;;;;;;;;;;;;;;;;;;;;;AAM/D"}},
    {"offset": {"line": 1607, "column": 0}, "map": {"version":3,"sources":["file:///Users/aaronbaker/knearme-workspace/review-agent-dashboard/src/components/dashboard/StatBlock.tsx"],"sourcesContent":["import type { LucideIcon } from 'lucide-react'\n\n/**\n * StatBlock - Mission Control style stat display\n *\n * A colored icon box with bold value and label, used across dashboard pages\n * for displaying key metrics with visual hierarchy.\n *\n * @example\n * <StatBlock\n *   label=\"Total Searches\"\n *   value={1234}\n *   icon={Search}\n *   color=\"emerald\"\n * />\n */\n\nexport type StatBlockColor = 'emerald' | 'amber' | 'cyan' | 'violet' | 'red' | 'blue'\n\ninterface StatBlockProps {\n  label: string\n  value: string | number\n  icon: LucideIcon\n  color?: StatBlockColor\n  /** Optional subtitle text below the value */\n  subtitle?: string\n}\n\nconst colorClasses: Record<StatBlockColor, string> = {\n  emerald: 'text-emerald-400 bg-emerald-500/10 border-emerald-500/20',\n  amber: 'text-amber-400 bg-amber-500/10 border-amber-500/20',\n  cyan: 'text-cyan-400 bg-cyan-500/10 border-cyan-500/20',\n  violet: 'text-violet-400 bg-violet-500/10 border-violet-500/20',\n  red: 'text-red-400 bg-red-500/10 border-red-500/20',\n  blue: 'text-blue-400 bg-blue-500/10 border-blue-500/20',\n}\n\nexport function StatBlock({\n  label,\n  value,\n  icon: Icon,\n  color = 'emerald',\n  subtitle,\n}: StatBlockProps) {\n  return (\n    <div className=\"flex items-center gap-3 px-4 py-3 bg-zinc-900/50 border border-zinc-800/50 rounded-lg\">\n      <div\n        className={`flex items-center justify-center h-10 w-10 rounded-lg border ${colorClasses[color]}`}\n      >\n        <Icon className=\"h-5 w-5\" />\n      </div>\n      <div>\n        <p className=\"text-2xl font-bold font-mono text-zinc-100 tabular-nums\">\n          {typeof value === 'number' ? value.toLocaleString() : value}\n        </p>\n        <p className=\"text-xs font-medium text-zinc-500 uppercase tracking-wider\">\n          {label}\n        </p>\n        {subtitle && (\n          <p className=\"text-xs text-zinc-600 mt-0.5\">{subtitle}</p>\n        )}\n      </div>\n    </div>\n  )\n}\n\n/**\n * StatBlockGrid - Wrapper for consistent grid layout of StatBlocks\n */\ninterface StatBlockGridProps {\n  children: React.ReactNode\n  columns?: 2 | 3 | 4\n}\n\nexport function StatBlockGrid({ children, columns = 4 }: StatBlockGridProps) {\n  const gridCols = {\n    2: 'grid-cols-1 sm:grid-cols-2',\n    3: 'grid-cols-1 sm:grid-cols-2 lg:grid-cols-3',\n    4: 'grid-cols-2 lg:grid-cols-4',\n  }\n\n  return <div className={`grid ${gridCols[columns]} gap-3`}>{children}</div>\n}\n"],"names":[],"mappings":";;;;;;;;AA4BA,MAAM,eAA+C;IACnD,SAAS;IACT,OAAO;IACP,MAAM;IACN,QAAQ;IACR,KAAK;IACL,MAAM;AACR;AAEO,SAAS,UAAU,EACxB,KAAK,EACL,KAAK,EACL,MAAM,IAAI,EACV,QAAQ,SAAS,EACjB,QAAQ,EACO;IACf,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBACC,WAAW,CAAC,6DAA6D,EAAE,YAAY,CAAC,MAAM,EAAE;0BAEhG,cAAA,8OAAC;oBAAK,WAAU;;;;;;;;;;;0BAElB,8OAAC;;kCACC,8OAAC;wBAAE,WAAU;kCACV,OAAO,UAAU,WAAW,MAAM,cAAc,KAAK;;;;;;kCAExD,8OAAC;wBAAE,WAAU;kCACV;;;;;;oBAEF,0BACC,8OAAC;wBAAE,WAAU;kCAAgC;;;;;;;;;;;;;;;;;;AAKvD;AAUO,SAAS,cAAc,EAAE,QAAQ,EAAE,UAAU,CAAC,EAAsB;IACzE,MAAM,WAAW;QACf,GAAG;QACH,GAAG;QACH,GAAG;IACL;IAEA,qBAAO,8OAAC;QAAI,WAAW,CAAC,KAAK,EAAE,QAAQ,CAAC,QAAQ,CAAC,MAAM,CAAC;kBAAG;;;;;;AAC7D"}},
    {"offset": {"line": 1699, "column": 0}, "map": {"version":3,"sources":["file:///Users/aaronbaker/knearme-workspace/review-agent-dashboard/src/app/articles/page.tsx"],"sourcesContent":["import Link from 'next/link';\nimport { ArticleCard, type ArticleData } from '@/components/dashboard/ArticleCard';\nimport { getArticles as getArticlesQuery, getArticleStatusCounts } from '@/lib/supabase/queries';\nimport { PageHeader } from '@/components/dashboard/PageHeader';\nimport { StatBlock, StatBlockGrid } from '@/components/dashboard/StatBlock';\nimport type { ArticleSortOption } from '@/lib/types';\nimport { updateArticleStatus } from './actions';\nimport { Search, FileText, CheckCircle2, Clock } from 'lucide-react';\n\n/**\n * Builds a URL with the current filters and optional overrides\n */\nfunction buildQueryString(\n  currentParams: Record<string, string | undefined>,\n  overrides: Record<string, string | undefined> = {}\n): string {\n  const merged = { ...currentParams, ...overrides };\n  const params = new URLSearchParams();\n\n  Object.entries(merged).forEach(([key, value]) => {\n    if (value !== undefined && value !== '') {\n      params.set(key, value);\n    }\n  });\n\n  const queryString = params.toString();\n  return queryString ? `?${queryString}` : '';\n}\n\n/**\n * Fetches articles data from Supabase with optional filters.\n */\nasync function getArticlesData(searchParams: {\n  status?: string;\n  search?: string;\n  sort?: string;\n  page?: string;\n}): Promise<{\n  articles: ArticleData[];\n  totalCount: number;\n  statsTotal: number;\n  publishedCount: number;\n  draftCount: number;\n  currentPage: number;\n  totalPages: number;\n}> {\n  const page = parseInt(searchParams.page || '1', 10);\n  const limit = 10;\n\n  // Parse status filter\n  const statusFilter = searchParams.status === 'draft' || searchParams.status === 'published'\n    ? searchParams.status\n    : undefined;\n\n  // Parse sort option\n  const sortOption = (searchParams.sort as ArticleSortOption) || 'generated_desc';\n\n  // Fetch articles with filters\n  const result = await getArticlesQuery(\n    {\n      status: statusFilter,\n      search: searchParams.search || undefined,\n      sort: sortOption,\n    },\n    page,\n    limit\n  );\n\n  // Transform to ArticleData format expected by ArticleCard component\n  const articles: ArticleData[] = result.data.map((article) => ({\n    id: article.id,\n    title: article.title,\n    slug: article.slug,\n    status: article.status,\n    generatedAt: article.generated_at,\n    wordCount: article.content_markdown?.split(/\\s+/).filter(Boolean).length || 0,\n    contractor: {\n      id: article.contractor?.id || '',\n      businessName: article.contractor?.business_name || 'Unknown',\n      city: article.contractor?.city || '',\n      state: article.contractor?.state || '',\n    },\n  }));\n\n  // Count published and draft articles matching the current search\n  const { total, published, draft } = await getArticleStatusCounts(searchParams.search);\n\n  return {\n    articles,\n    totalCount: result.total,\n    statsTotal: total,\n    publishedCount: published,\n    draftCount: draft,\n    currentPage: page,\n    totalPages: Math.ceil(result.total / limit),\n  };\n}\n\n/**\n * Filter section component with Mission Control styling.\n */\nfunction FiltersSection({\n  currentParams,\n}: {\n  currentParams: Record<string, string | undefined>;\n}) {\n  return (\n    <form action=\"/articles\" method=\"GET\">\n      <div className=\"flex flex-col gap-3 lg:flex-row lg:items-center\">\n        {/* Status Filter */}\n        <select\n          name=\"status\"\n          defaultValue={currentParams.status || ''}\n          className=\"h-9 w-[140px] px-3 rounded-lg border-zinc-700/50 bg-zinc-800/50 text-sm text-zinc-300 font-mono focus:border-emerald-500/50 focus:outline-none\"\n        >\n          <option value=\"\">All Statuses</option>\n          <option value=\"draft\">Draft</option>\n          <option value=\"published\">Published</option>\n        </select>\n\n        {/* Search Input */}\n        <div className=\"relative flex-1 min-w-[200px]\">\n          <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-zinc-500\" />\n          <input\n            type=\"text\"\n            name=\"search\"\n            defaultValue={currentParams.search || ''}\n            placeholder=\"Search by title or contractor...\"\n            className=\"w-full h-9 pl-10 pr-4 rounded-lg border border-zinc-700/50 bg-zinc-800/50 text-sm text-zinc-200 placeholder:text-zinc-500 focus:border-emerald-500/50 focus:outline-none\"\n          />\n        </div>\n\n        {/* Sort Filter */}\n        <select\n          name=\"sort\"\n          defaultValue={currentParams.sort || 'generated_desc'}\n          className=\"h-9 w-[160px] px-3 rounded-lg border-zinc-700/50 bg-zinc-800/50 text-sm text-zinc-300 font-mono focus:border-emerald-500/50 focus:outline-none\"\n        >\n          <option value=\"generated_desc\">Newest First</option>\n          <option value=\"generated_asc\">Oldest First</option>\n          <option value=\"title_asc\">Title A-Z</option>\n          <option value=\"title_desc\">Title Z-A</option>\n        </select>\n\n        {/* Action Buttons */}\n        <div className=\"flex items-center gap-2\">\n          <button\n            type=\"submit\"\n            className=\"h-9 px-4 text-xs font-mono bg-emerald-500/10 hover:bg-emerald-500/20 text-emerald-400 border border-emerald-500/20 rounded-lg transition-colors\"\n          >\n            Apply\n          </button>\n          <Link\n            href=\"/articles\"\n            className=\"h-9 px-4 text-xs font-mono text-zinc-400 hover:text-zinc-200 hover:bg-zinc-800/50 border border-zinc-700/50 rounded-lg transition-colors flex items-center\"\n          >\n            Clear\n          </Link>\n        </div>\n      </div>\n    </form>\n  );\n}\n\n/**\n * Generate page numbers to display in pagination\n */\nfunction getPageNumbers(currentPage: number, totalPages: number): (number | 'ellipsis')[] {\n  const pages: (number | 'ellipsis')[] = [];\n\n  if (totalPages <= 7) {\n    for (let i = 1; i <= totalPages; i++) {\n      pages.push(i);\n    }\n  } else {\n    pages.push(1);\n\n    if (currentPage > 3) {\n      pages.push('ellipsis');\n    }\n\n    const start = Math.max(2, currentPage - 1);\n    const end = Math.min(totalPages - 1, currentPage + 1);\n\n    for (let i = start; i <= end; i++) {\n      pages.push(i);\n    }\n\n    if (currentPage < totalPages - 2) {\n      pages.push('ellipsis');\n    }\n\n    if (totalPages > 1) {\n      pages.push(totalPages);\n    }\n  }\n\n  return pages;\n}\n\n/**\n * Pagination component with Mission Control styling.\n */\nfunction Pagination({\n  currentPage,\n  totalPages,\n  totalCount,\n  currentParams,\n}: {\n  currentPage: number;\n  totalPages: number;\n  totalCount: number;\n  currentParams: Record<string, string | undefined>;\n}) {\n  const pageNumbers = getPageNumbers(currentPage, totalPages);\n\n  // Build params without page for link building\n  const baseParams = { ...currentParams };\n  delete baseParams.page;\n\n  return (\n    <div className=\"flex items-center justify-between border-t border-zinc-800/50 px-4 py-3 bg-zinc-900/50\">\n      <p className=\"text-xs font-mono text-zinc-500\">\n        Page <span className=\"text-zinc-300\">{currentPage}/{totalPages}</span> &middot; {totalCount.toLocaleString()} total\n      </p>\n\n      <div className=\"flex items-center gap-2\">\n        {currentPage > 1 && (\n          <Link\n            href={`/articles${buildQueryString(baseParams, { page: String(currentPage - 1) })}`}\n            className=\"px-3 py-1.5 text-xs font-mono bg-zinc-800/50 hover:bg-zinc-700/50 text-zinc-300 border border-zinc-700/50 rounded transition-colors\"\n          >\n            &larr; Prev\n          </Link>\n        )}\n\n        <div className=\"hidden sm:flex items-center gap-1\">\n          {pageNumbers.map((page, index) => {\n            if (page === 'ellipsis') {\n              return (\n                <span key={`ellipsis-${index}`} className=\"px-2 text-zinc-600 font-mono\">\n                  ...\n                </span>\n              );\n            }\n\n            const isCurrentPage = page === currentPage;\n\n            return (\n              <Link\n                key={page}\n                href={`/articles${buildQueryString(baseParams, { page: String(page) })}`}\n                className={`h-8 w-8 flex items-center justify-center text-xs font-mono rounded border transition-colors ${\n                  isCurrentPage\n                    ? 'bg-emerald-500/10 text-emerald-400 border-emerald-500/20'\n                    : 'bg-zinc-800/50 text-zinc-400 border-zinc-700/50 hover:bg-zinc-700/50 hover:text-zinc-200'\n                }`}\n              >\n                {page}\n              </Link>\n            );\n          })}\n        </div>\n\n        {currentPage < totalPages && (\n          <Link\n            href={`/articles${buildQueryString(baseParams, { page: String(currentPage + 1) })}`}\n            className=\"px-3 py-1.5 text-xs font-mono bg-zinc-800/50 hover:bg-zinc-700/50 text-zinc-300 border border-zinc-700/50 rounded transition-colors\"\n          >\n            Next &rarr;\n          </Link>\n        )}\n      </div>\n    </div>\n  );\n}\n\n/**\n * Articles list page (Server Component).\n * Mission Control styling with dark theme.\n */\nexport default async function ArticlesPage({\n  searchParams,\n}: {\n  searchParams: Promise<{ [key: string]: string | string[] | undefined }>;\n}) {\n  const params = await searchParams;\n\n  // Normalize params to string | undefined\n  const normalizedParams: Record<string, string | undefined> = {\n    status: typeof params.status === 'string' ? params.status : undefined,\n    search: typeof params.search === 'string' ? params.search : undefined,\n    sort: typeof params.sort === 'string' ? params.sort : undefined,\n    page: typeof params.page === 'string' ? params.page : undefined,\n  };\n\n  const { articles, totalCount, statsTotal, publishedCount, draftCount, currentPage, totalPages } =\n    await getArticlesData(normalizedParams);\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Page Header */}\n      <PageHeader\n        title=\"Articles\"\n        subtitle=\"Manage AI-generated contractor review articles\"\n        icon={FileText}\n        badge=\"Content\"\n        badgeColor=\"emerald\"\n        recordCount={totalCount}\n        tableName=\"review_articles\"\n      />\n\n      {/* Stats Grid */}\n      <StatBlockGrid columns={3}>\n        <StatBlock\n          label=\"Total Articles\"\n          value={statsTotal}\n          icon={FileText}\n          color=\"emerald\"\n        />\n        <StatBlock\n          label=\"Published\"\n          value={publishedCount}\n          icon={CheckCircle2}\n          color=\"cyan\"\n        />\n        <StatBlock\n          label=\"Drafts\"\n          value={draftCount}\n          icon={Clock}\n          color=\"amber\"\n        />\n      </StatBlockGrid>\n\n      {/* Filters Section */}\n      <div className=\"p-4 bg-zinc-900/30 border border-zinc-800/50 rounded-lg\">\n        <div className=\"flex items-center gap-2 mb-4\">\n          <div className=\"h-2 w-2 rounded-full bg-emerald-400 animate-pulse\" />\n          <span className=\"text-xs font-mono uppercase tracking-wider text-zinc-500\">\n            Filters\n          </span>\n        </div>\n        <FiltersSection currentParams={normalizedParams} />\n      </div>\n\n      {/* Articles List */}\n      <div className=\"bg-zinc-900/30 border border-zinc-800/50 rounded-lg overflow-hidden\">\n        {/* Table Header */}\n        <div className=\"flex items-center justify-between px-4 py-3 border-b border-zinc-800/50 bg-zinc-900/50\">\n          <div className=\"flex items-center gap-2\">\n            <div className=\"h-2 w-2 rounded-full bg-cyan-400\" />\n            <span className=\"text-xs font-mono uppercase tracking-wider text-zinc-500\">\n              Article Records\n            </span>\n          </div>\n          <span className=\"text-xs font-mono text-zinc-600\">\n            Showing {articles.length} of {totalCount.toLocaleString()}\n          </span>\n        </div>\n\n        <div className=\"divide-y divide-zinc-800/30\">\n          {articles.length > 0 ? (\n            articles.map((article) => (\n              <ArticleCard\n                key={article.id}\n                article={article}\n                onPublishToggle={updateArticleStatus}\n              />\n            ))\n          ) : (\n            <div className=\"p-12 text-center\">\n              <div className=\"inline-flex items-center justify-center h-16 w-16 rounded-full bg-zinc-800/50 border border-zinc-700/50 mb-4\">\n                <FileText className=\"h-8 w-8 text-zinc-600\" />\n              </div>\n              <h3 className=\"text-lg font-semibold text-zinc-300 mb-1\">\n                No articles found\n              </h3>\n              <p className=\"text-sm text-zinc-500 max-w-md mx-auto\">\n                {normalizedParams.search || normalizedParams.status\n                  ? 'No articles match your current filters. Try adjusting your search criteria.'\n                  : 'Articles will appear here once they are generated from contractor reviews.'}\n              </p>\n              <p className=\"mt-4 text-xs font-mono text-zinc-600\">\n                Table: <code className=\"px-1.5 py-0.5 bg-zinc-800/50 rounded\">review_articles</code>\n              </p>\n            </div>\n          )}\n        </div>\n\n        {/* Pagination */}\n        {totalPages > 1 && (\n          <Pagination\n            currentPage={currentPage}\n            totalPages={totalPages}\n            totalCount={totalCount}\n            currentParams={normalizedParams}\n          />\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}