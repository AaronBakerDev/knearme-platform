# Signup Flow – Playwright Run (2025-12-10)

- Context: local dev at `http://localhost:3000` with `.env.local` Supabase keys; Node v22.21.1 via nvm.
- Test data: email `hi+signup-playwright-2025-12-10@aaronbaker.co`, password `QaTest123!`.
- Steps:
  1) Navigate to `/signup`.
  2) Fill Email/Password/Confirm; submit “Create Account”.
- Result: PASS. Success screen shown with email echo (“Check Your Email”) and CTA to use different email or log in.
- Notes: Verification email delivery not asserted (no inbox hook yet). No screenshot captured this run.
- Next actions: use Playwright MCP to open the test inbox and click the verification link to complete the flow; add API error simulation (429 / network fail) to cover SC-05 edge cases.

## Run 2
- Test data: email `hi+signup-playwright-2025-12-10-02@aaronbaker.co`, password `QaTest123!`.
- Steps: cleared cookies, navigated to `/signup`, filled form, submitted.
- Result: PASS. Success screen shown with entered email.
- Observations: Before clearing cookies, navigating to `/signup` redirected to `/dashboard`/`/profile/setup` and threw `TypeError: navigation.usePathname is not a function` in the app error boundary; clearing cookies restored access to `/signup`. Logged separately as a bug candidate.
- Fix applied afterward: replaced `next-nprogress-bar` with custom client `AppProgressBar` (uses `nprogress-v2` + `usePathname`) to remove the `navigation` collision.

## Run 3 (Playwright MCP end-to-end attempt)
- Test data: email `hi+signup-mcp-2025-12-10-03@aaronbaker.co`, password `QaTest123!`.
- Steps: used Playwright MCP to drive `/signup`, reached “Check Your Email” success, redirected into authenticated onboarding; completed Business and Services steps; added service area “Denver, CO”.
- Result: BLOCKED. On `Complete Setup`, Supabase returned `infinite recursion detected in policy for relation "contractors"` (HTTP 500). User remains stuck on `/profile/setup`.
- Notes: PWA install prompt overlay blocked the Services “Continue” button until dismissed. Console showed repeated hydration mismatch warnings and intermittent 500s to the Supabase domain when opening the user menu.
- Cleanup: Supabase auth user `hi+signup-mcp-2025-12-10-03@aaronbaker.co` was created; profile write failed.
